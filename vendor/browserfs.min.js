"use strict";(function(global){function replacer(key,value){return void 0===value?""+value:"number"!=typeof value||!isNaN(value)&&isFinite(value)?"function"==typeof value||value instanceof RegExp?value.toString():value:value.toString()}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected){return actual===expected?!0:actual instanceof Date&&expected instanceof Date?actual.getTime()===expected.getTime():actual instanceof RegExp&&expected instanceof RegExp?actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase:"object"!=typeof actual&&"object"!=typeof expected?actual==expected:objEquiv(actual,expected)}function isUndefinedOrNull(value){return null===value||void 0===value}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b){if(isUndefinedOrNull(a)||isUndefinedOrNull(b))return!1;if(a.prototype!==b.prototype)return!1;if(isArguments(a))return isArguments(b)?(a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b)):!1;try{var ka=Object_keys(a),kb=Object_keys(b),key,i}catch(e){return!1}if(ka.length!=kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!=kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key]))return!1;return!0}function expectedException(actual,expected){return actual&&expected?Object.prototype.toString.call(expected)=="[object RegExp]"?expected.test(actual):actual instanceof expected?!0:expected.call({},actual)===!0?!0:!1:!1}function _throws(shouldThrow,block,expected,message){var actual;"string"==typeof expected&&(message=expected,expected=null);try{block()}catch(e){actual=e}if(message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message),!shouldThrow&&expectedException(actual,expected)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}var create=Object.create||function(p){function f(){}if(!p)throw Error("no type");return f.prototype=p,new f},util={inherits:function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}},pSlice=Array.prototype.slice,Object_keys=typeof Object.keys=="function"?Object.keys:function(obj){var keys=[];for(var key in obj)keys.push(key);return keys},assert=ok;global.assert=assert,"object"==typeof module&&typeof module.exports=="object"&&(module.exports=assert),assert.AssertionError=function AssertionError(options){this.name="AssertionError",this.message=options.message,this.actual=options.actual,this.expected=options.expected,this.operator=options.operator;var stackStartFunction=options.stackStartFunction||fail;Error.captureStackTrace&&Error.captureStackTrace(this,stackStartFunction)},util.inherits(assert.AssertionError,Error),assert.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",truncate(JSON.stringify(this.actual,replacer),128),this.operator,truncate(JSON.stringify(this.expected,replacer),128)].join(" ")},assert.fail=fail,assert.ok=ok,assert.equal=function equal(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function notEqual(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function deepEqual(actual,expected,message){_deepEqual(actual,expected)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.notDeepEqual=function notDeepEqual(actual,expected,message){_deepEqual(actual,expected)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.strictEqual=function strictEqual(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function notStrictEqual(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws.apply(this,[!0].concat(pSlice.call(arguments)))},assert.doesNotThrow=function(block,message){_throws.apply(this,[!1].concat(pSlice.call(arguments)))},assert.ifError=function(err){if(err)throw err},"function"==typeof define&&define.amd&&define("assert",function(){return assert})})(this);var ArrayBuffer,ArrayBufferView,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,DataView;(function(){function raise_INDEX_SIZE_ERR(){throw"undefined"!=typeof document&&document.createTextNode("").splitText(1),new RangeError("INDEX_SIZE_ERR")}function configureProperties(obj){if(Object.getOwnPropertyNames&&Object.defineProperty){var props=Object.getOwnPropertyNames(obj),i;for(i=0;i<props.length;i+=1)Object.defineProperty(obj,props[i],{value:obj[props[i]],writable:!1,enumerable:!1,configurable:!1})}}function makeArrayAccessors(obj){function makeArrayAccessor(index){Object.defineProperty(obj,index,{get:function(){return obj._getter(index)},set:function(v){obj._setter(index,v)},enumerable:!0,configurable:!1})}if(Object.defineProperty){var i;for(i=0;i<obj.length;i+=1)makeArrayAccessor(i)}}function as_signed(value,bits){var s=32-bits;return value<<s>>s}function as_unsigned(value,bits){var s=32-bits;return value<<s>>>s}function packInt8(n){return[255&n]}function unpackInt8(bytes){return as_signed(bytes[0],8)}function packUint8(n){return[255&n]}function unpackUint8(bytes){return as_unsigned(bytes[0],8)}function packInt16(n){return[255&n>>8,255&n]}function unpackInt16(bytes){return as_signed(bytes[0]<<8|bytes[1],16)}function packUint16(n){return[255&n>>8,255&n]}function unpackUint16(bytes){return as_unsigned(bytes[0]<<8|bytes[1],16)}function packInt32(n){return[255&n>>24,255&n>>16,255&n>>8,255&n]}function unpackInt32(bytes){return as_signed(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packUint32(n){return[255&n>>24,255&n>>16,255&n>>8,255&n]}function unpackUint32(bytes){return as_unsigned(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packIEEE754(v,ebits,fbits){var bias=(1<<ebits-1)-1,s,e,f,ln,i,bits,str,bytes;for(isNaN(v)?(e=(1<<bias)-1,f=Math.pow(2,fbits-1),s=0):1/0===v||v===-1/0?(e=(1<<bias)-1,f=0,s=0>v?1:0):0===v?(e=0,f=0,s=1/v===-1/0?1:0):(s=0>v,v=Math.abs(v),v>=Math.pow(2,1-bias)?(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),bias),e=ln+bias,f=Math.round(v*Math.pow(2,fbits-ln)-Math.pow(2,fbits))):(e=0,f=Math.round(v/Math.pow(2,1-bias-fbits)))),bits=[],i=fbits;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=ebits;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);for(bits.push(s?1:0),bits.reverse(),str=bits.join(""),bytes=[];str.length;)bytes.push(parseInt(str.substring(0,8),2)),str=str.substring(8);return bytes}function unpackIEEE754(bytes,ebits,fbits){var bits=[],i,j,b,str,bias,s,e,f;for(i=bytes.length;i;i-=1)for(b=bytes[i-1],j=8;j;j-=1)bits.push(b%2?1:0),b>>=1;return bits.reverse(),str=bits.join(""),bias=(1<<ebits-1)-1,s=parseInt(str.substring(0,1),2)?-1:1,e=parseInt(str.substring(1,1+ebits),2),f=parseInt(str.substring(1+ebits),2),e===(1<<ebits)-1?0!==f?0/0:1/0*s:e>0?s*Math.pow(2,e-bias)*(1+f/Math.pow(2,fbits)):0!==f?s*Math.pow(2,-(bias-1))*(f/Math.pow(2,fbits)):0>s?-0:0}function unpackFloat64(b){return unpackIEEE754(b,11,52)}function packFloat64(v){return packIEEE754(v,11,52)}function unpackFloat32(b){return unpackIEEE754(b,8,23)}function packFloat32(v){return packIEEE754(v,8,23)}var ECMAScript={ToInt32:function(v){return v>>0},ToUint32:function(v){return v>>>0}};Object.prototype.__defineGetter__&&!Object.defineProperty&&(Object.defineProperty=function(obj,prop,desc){desc.hasOwnProperty("get")&&obj.__defineGetter__(prop,desc.get),desc.hasOwnProperty("set")&&obj.__defineSetter__(prop,desc.set)}),ArrayBuffer||function(){function makeTypedArrayConstructor(bytesPerElement,pack,unpack){var ctor;return ctor=function(buffer,byteOffset,length){var array,sequence,i,s;if(arguments.length&&typeof arguments[0]!="number")if(typeof arguments[0]=="object"&&arguments[0].constructor===ctor)for(array=arguments[0],this.length=array.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)this._setter(i,array._getter(i));else if(typeof arguments[0]!="object"||arguments[0]instanceof ArrayBuffer){if(!(typeof arguments[0]=="object"&&arguments[0]instanceof ArrayBuffer))throw new TypeError("Unexpected argument type(s)");if(this.buffer=buffer,this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");arguments.length<3?(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT&&raise_INDEX_SIZE_ERR(),this.length=this.byteLength/this.BYTES_PER_ELEMENT):(this.length=ECMAScript.ToUint32(length),this.byteLength=this.length*this.BYTES_PER_ELEMENT),this.byteOffset+this.byteLength>this.buffer.byteLength&&raise_INDEX_SIZE_ERR()}else for(sequence=arguments[0],this.length=ECMAScript.ToUint32(sequence.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)s=sequence[i],this._setter(i,Number(s));else{if(this.length=ECMAScript.ToInt32(arguments[0]),0>length)throw new RangeError("ArrayBufferView size is not a small enough positive integer.");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0}this.constructor=ctor},ctor.prototype=new ArrayBufferView,ctor.prototype.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._pack=pack,ctor.prototype._unpack=unpack,ctor.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._getter=function(index){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),!(index>=this.length)){var bytes=[],i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)bytes.push(this.buffer._bytes[o]);return this._unpack(bytes)}},ctor.prototype.get=ctor.prototype._getter,ctor.prototype._setter=function(index,value){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),!(index>=this.length)){var bytes=this._pack(value),i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)this.buffer._bytes[o]=bytes[i]}},ctor.prototype.set=function(index,value){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var array,sequence,offset,len,i,s,d,byteOffset,byteLength,tmp;if(typeof arguments[0]=="object"&&arguments[0].constructor===this.constructor)if(array=arguments[0],offset=ECMAScript.ToUint32(arguments[1]),offset+array.length>this.length&&raise_INDEX_SIZE_ERR(),byteOffset=this.byteOffset+offset*this.BYTES_PER_ELEMENT,byteLength=array.length*this.BYTES_PER_ELEMENT,array.buffer===this.buffer){for(tmp=[],i=0,s=array.byteOffset;byteLength>i;i+=1,s+=1)tmp[i]=array.buffer._bytes[s];for(i=0,d=byteOffset;byteLength>i;i+=1,d+=1)this.buffer._bytes[d]=tmp[i]}else for(i=0,s=array.byteOffset,d=byteOffset;byteLength>i;i+=1,s+=1,d+=1)this.buffer._bytes[d]=array.buffer._bytes[s];else{if(typeof arguments[0]!="object"||typeof arguments[0].length=="undefined")throw new TypeError("Unexpected argument type(s)");for(sequence=arguments[0],len=ECMAScript.ToUint32(sequence.length),offset=ECMAScript.ToUint32(arguments[1]),offset+len>this.length&&raise_INDEX_SIZE_ERR(),i=0;len>i;i+=1)s=sequence[i],this._setter(offset+i,Number(s))}},ctor.prototype.subarray=function(start,end){function clamp(v,min,max){return min>v?min:v>max?max:v}start=ECMAScript.ToInt32(start),end=ECMAScript.ToInt32(end),arguments.length<1&&(start=0),arguments.length<2&&(end=this.length),0>start&&(start=this.length+start),0>end&&(end=this.length+end),start=clamp(start,0,this.length),end=clamp(end,0,this.length);var len=end-start;return 0>len&&(len=0),new this.constructor(this.buffer,start*this.BYTES_PER_ELEMENT,len)},ctor}ArrayBuffer=function(length){if(length=ECMAScript.ToInt32(length),0>length)throw new RangeError("ArrayBuffer size is not a small enough positive integer.");this.byteLength=length,this._bytes=[],this._bytes.length=length;var i;for(i=0;i<this.byteLength;i+=1)this._bytes[i]=0;configureProperties(this)},ArrayBufferView=function(){},Int8Array=Int8Array||makeTypedArrayConstructor(1,packInt8,unpackInt8),Uint8Array=Uint8Array||makeTypedArrayConstructor(1,packUint8,unpackUint8),Int16Array=Int16Array||makeTypedArrayConstructor(2,packInt16,unpackInt16),Uint16Array=Uint16Array||makeTypedArrayConstructor(2,packUint16,unpackUint16),Int32Array=Int32Array||makeTypedArrayConstructor(4,packInt32,unpackInt32),Uint32Array=Uint32Array||makeTypedArrayConstructor(4,packUint32,unpackUint32),Float32Array=Float32Array||makeTypedArrayConstructor(4,packFloat32,unpackFloat32),Float64Array=Float64Array||makeTypedArrayConstructor(8,packFloat64,unpackFloat64)}(),DataView||function(){function r(array,index){return typeof array.get=="function"?array.get(index):array[index]}function makeDataView_getter(arrayType){return function(byteOffset,littleEndian){byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength&&raise_INDEX_SIZE_ERR(),byteOffset+=this.byteOffset;var uint8Array=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),bytes=[],i;for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(uint8Array,i));return Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),r(new arrayType(new Uint8Array(bytes).buffer),0)}}function makeDataView_setter(arrayType){return function(byteOffset,value,littleEndian){byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength&&raise_INDEX_SIZE_ERR();var typeArray=new arrayType([value]),byteArray=new Uint8Array(typeArray.buffer),bytes=[],i,byteView;for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(byteArray,i));Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),byteView=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),byteView.set(bytes)}}var IS_BIG_ENDIAN=function(){var u16array=new Uint16Array([4660]),u8array=new Uint8Array(u16array.buffer);return r(u8array,0)===18}();DataView=function(buffer,byteOffset,byteLength){if(!("object"==typeof buffer&&buffer instanceof ArrayBuffer))throw new TypeError("TypeError");this.buffer=buffer,this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),this.byteLength=arguments.length<3?this.buffer.byteLength-this.byteOffset:ECMAScript.ToUint32(byteLength),this.byteOffset+this.byteLength>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),configureProperties(this)},ArrayBufferView&&(DataView.prototype=new ArrayBufferView),DataView.prototype.getUint8=makeDataView_getter(Uint8Array),DataView.prototype.getInt8=makeDataView_getter(Int8Array),DataView.prototype.getUint16=makeDataView_getter(Uint16Array),DataView.prototype.getInt16=makeDataView_getter(Int16Array),DataView.prototype.getUint32=makeDataView_getter(Uint32Array),DataView.prototype.getInt32=makeDataView_getter(Int32Array),DataView.prototype.getFloat32=makeDataView_getter(Float32Array),DataView.prototype.getFloat64=makeDataView_getter(Float64Array),DataView.prototype.setUint8=makeDataView_setter(Uint8Array),DataView.prototype.setInt8=makeDataView_setter(Int8Array),DataView.prototype.setUint16=makeDataView_setter(Uint16Array),DataView.prototype.setInt16=makeDataView_setter(Int16Array),DataView.prototype.setUint32=makeDataView_setter(Uint32Array),DataView.prototype.setInt32=makeDataView_setter(Int32Array),DataView.prototype.setFloat32=makeDataView_setter(Float32Array),DataView.prototype.setFloat64=makeDataView_setter(Float64Array)}()})(),function(global){function replacer(key,value){return void 0===value?""+value:"number"!=typeof value||!isNaN(value)&&isFinite(value)?"function"==typeof value||value instanceof RegExp?value.toString():value:value.toString()}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected){return actual===expected?!0:actual instanceof Date&&expected instanceof Date?actual.getTime()===expected.getTime():actual instanceof RegExp&&expected instanceof RegExp?actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase:"object"!=typeof actual&&"object"!=typeof expected?actual==expected:objEquiv(actual,expected)}function isUndefinedOrNull(value){return null===value||void 0===value}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b){if(isUndefinedOrNull(a)||isUndefinedOrNull(b))return!1;if(a.prototype!==b.prototype)return!1;if(isArguments(a))return isArguments(b)?(a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b)):!1;try{var ka=Object_keys(a),kb=Object_keys(b),key,i}catch(e){return!1}if(ka.length!=kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!=kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key]))return!1;return!0}function expectedException(actual,expected){return actual&&expected?Object.prototype.toString.call(expected)=="[object RegExp]"?expected.test(actual):actual instanceof expected?!0:expected.call({},actual)===!0?!0:!1:!1}function _throws(shouldThrow,block,expected,message){var actual;"string"==typeof expected&&(message=expected,expected=null);try{block()}catch(e){actual=e}if(message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message),!shouldThrow&&expectedException(actual,expected)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}var create=Object.create||function(p){function f(){}if(!p)throw Error("no type");return f.prototype=p,new f},util={inherits:function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}},pSlice=Array.prototype.slice,Object_keys=typeof Object.keys=="function"?Object.keys:function(obj){var keys=[];for(var key in obj)keys.push(key);return keys},assert=ok;global.assert=assert,"object"==typeof module&&typeof module.exports=="object"&&(module.exports=assert),assert.AssertionError=function AssertionError(options){this.name="AssertionError",this.message=options.message,this.actual=options.actual,this.expected=options.expected,this.operator=options.operator;var stackStartFunction=options.stackStartFunction||fail;Error.captureStackTrace&&Error.captureStackTrace(this,stackStartFunction)},util.inherits(assert.AssertionError,Error),assert.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",truncate(JSON.stringify(this.actual,replacer),128),this.operator,truncate(JSON.stringify(this.expected,replacer),128)].join(" ")},assert.fail=fail,assert.ok=ok,assert.equal=function equal(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function notEqual(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function deepEqual(actual,expected,message){_deepEqual(actual,expected)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.notDeepEqual=function notDeepEqual(actual,expected,message){_deepEqual(actual,expected)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.strictEqual=function strictEqual(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function notStrictEqual(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws.apply(this,[!0].concat(pSlice.call(arguments)))},assert.doesNotThrow=function(block,message){_throws.apply(this,[!1].concat(pSlice.call(arguments)))},assert.ifError=function(err){if(err)throw err},"function"==typeof define&&define.amd&&define("assert",function(){return assert})}(this);var ArrayBuffer,ArrayBufferView,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,DataView;(function(){function raise_INDEX_SIZE_ERR(){throw"undefined"!=typeof document&&document.createTextNode("").splitText(1),new RangeError("INDEX_SIZE_ERR")}function configureProperties(obj){if(Object.getOwnPropertyNames&&Object.defineProperty){var props=Object.getOwnPropertyNames(obj),i;for(i=0;i<props.length;i+=1)Object.defineProperty(obj,props[i],{value:obj[props[i]],writable:!1,enumerable:!1,configurable:!1})}}function makeArrayAccessors(obj){function makeArrayAccessor(index){Object.defineProperty(obj,index,{get:function(){return obj._getter(index)},set:function(v){obj._setter(index,v)},enumerable:!0,configurable:!1})}if(Object.defineProperty){var i;for(i=0;i<obj.length;i+=1)makeArrayAccessor(i)}}function as_signed(value,bits){var s=32-bits;return value<<s>>s}function as_unsigned(value,bits){var s=32-bits;return value<<s>>>s}function packInt8(n){return[255&n]}function unpackInt8(bytes){return as_signed(bytes[0],8)}function packUint8(n){return[255&n]}function unpackUint8(bytes){return as_unsigned(bytes[0],8)}function packInt16(n){return[255&n>>8,255&n]}function unpackInt16(bytes){return as_signed(bytes[0]<<8|bytes[1],16)}function packUint16(n){return[255&n>>8,255&n]}function unpackUint16(bytes){return as_unsigned(bytes[0]<<8|bytes[1],16)}function packInt32(n){return[255&n>>24,255&n>>16,255&n>>8,255&n]}function unpackInt32(bytes){return as_signed(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packUint32(n){return[255&n>>24,255&n>>16,255&n>>8,255&n]}function unpackUint32(bytes){return as_unsigned(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packIEEE754(v,ebits,fbits){var bias=(1<<ebits-1)-1,s,e,f,ln,i,bits,str,bytes;for(isNaN(v)?(e=(1<<bias)-1,f=Math.pow(2,fbits-1),s=0):1/0===v||v===-1/0?(e=(1<<bias)-1,f=0,s=0>v?1:0):0===v?(e=0,f=0,s=1/v===-1/0?1:0):(s=0>v,v=Math.abs(v),v>=Math.pow(2,1-bias)?(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),bias),e=ln+bias,f=Math.round(v*Math.pow(2,fbits-ln)-Math.pow(2,fbits))):(e=0,f=Math.round(v/Math.pow(2,1-bias-fbits)))),bits=[],i=fbits;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=ebits;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);for(bits.push(s?1:0),bits.reverse(),str=bits.join(""),bytes=[];str.length;)bytes.push(parseInt(str.substring(0,8),2)),str=str.substring(8);return bytes}function unpackIEEE754(bytes,ebits,fbits){var bits=[],i,j,b,str,bias,s,e,f;for(i=bytes.length;i;i-=1)for(b=bytes[i-1],j=8;j;j-=1)bits.push(b%2?1:0),b>>=1;return bits.reverse(),str=bits.join(""),bias=(1<<ebits-1)-1,s=parseInt(str.substring(0,1),2)?-1:1,e=parseInt(str.substring(1,1+ebits),2),f=parseInt(str.substring(1+ebits),2),e===(1<<ebits)-1?0!==f?0/0:1/0*s:e>0?s*Math.pow(2,e-bias)*(1+f/Math.pow(2,fbits)):0!==f?s*Math.pow(2,-(bias-1))*(f/Math.pow(2,fbits)):0>s?-0:0}function unpackFloat64(b){return unpackIEEE754(b,11,52)}function packFloat64(v){return packIEEE754(v,11,52)}function unpackFloat32(b){return unpackIEEE754(b,8,23)}function packFloat32(v){return packIEEE754(v,8,23)}var ECMAScript={ToInt32:function(v){return v>>0},ToUint32:function(v){return v>>>0}};Object.prototype.__defineGetter__&&!Object.defineProperty&&(Object.defineProperty=function(obj,prop,desc){desc.hasOwnProperty("get")&&obj.__defineGetter__(prop,desc.get),desc.hasOwnProperty("set")&&obj.__defineSetter__(prop,desc.set)}),ArrayBuffer||function(){function makeTypedArrayConstructor(bytesPerElement,pack,unpack){var ctor;return ctor=function(buffer,byteOffset,length){var array,sequence,i,s;if(arguments.length&&typeof arguments[0]!="number")if(typeof arguments[0]=="object"&&arguments[0].constructor===ctor)for(array=arguments[0],this.length=array.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)this._setter(i,array._getter(i));else if(typeof arguments[0]!="object"||arguments[0]instanceof ArrayBuffer){if(!(typeof arguments[0]=="object"&&arguments[0]instanceof ArrayBuffer))throw new TypeError("Unexpected argument type(s)");if(this.buffer=buffer,this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");arguments.length<3?(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT&&raise_INDEX_SIZE_ERR(),this.length=this.byteLength/this.BYTES_PER_ELEMENT):(this.length=ECMAScript.ToUint32(length),this.byteLength=this.length*this.BYTES_PER_ELEMENT),this.byteOffset+this.byteLength>this.buffer.byteLength&&raise_INDEX_SIZE_ERR()}else for(sequence=arguments[0],this.length=ECMAScript.ToUint32(sequence.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)s=sequence[i],this._setter(i,Number(s));else{if(this.length=ECMAScript.ToInt32(arguments[0]),0>length)throw new RangeError("ArrayBufferView size is not a small enough positive integer.");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0}this.constructor=ctor},ctor.prototype=new ArrayBufferView,ctor.prototype.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._pack=pack,ctor.prototype._unpack=unpack,ctor.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._getter=function(index){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),!(index>=this.length)){var bytes=[],i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)bytes.push(this.buffer._bytes[o]);return this._unpack(bytes)}},ctor.prototype.get=ctor.prototype._getter,ctor.prototype._setter=function(index,value){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),!(index>=this.length)){var bytes=this._pack(value),i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)this.buffer._bytes[o]=bytes[i]}},ctor.prototype.set=function(index,value){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var array,sequence,offset,len,i,s,d,byteOffset,byteLength,tmp;if(typeof arguments[0]=="object"&&arguments[0].constructor===this.constructor)if(array=arguments[0],offset=ECMAScript.ToUint32(arguments[1]),offset+array.length>this.length&&raise_INDEX_SIZE_ERR(),byteOffset=this.byteOffset+offset*this.BYTES_PER_ELEMENT,byteLength=array.length*this.BYTES_PER_ELEMENT,array.buffer===this.buffer){for(tmp=[],i=0,s=array.byteOffset;byteLength>i;i+=1,s+=1)tmp[i]=array.buffer._bytes[s];for(i=0,d=byteOffset;byteLength>i;i+=1,d+=1)this.buffer._bytes[d]=tmp[i]}else for(i=0,s=array.byteOffset,d=byteOffset;byteLength>i;i+=1,s+=1,d+=1)this.buffer._bytes[d]=array.buffer._bytes[s];else{if(typeof arguments[0]!="object"||typeof arguments[0].length=="undefined")throw new TypeError("Unexpected argument type(s)");for(sequence=arguments[0],len=ECMAScript.ToUint32(sequence.length),offset=ECMAScript.ToUint32(arguments[1]),offset+len>this.length&&raise_INDEX_SIZE_ERR(),i=0;len>i;i+=1)s=sequence[i],this._setter(offset+i,Number(s))}},ctor.prototype.subarray=function(start,end){function clamp(v,min,max){return min>v?min:v>max?max:v}start=ECMAScript.ToInt32(start),end=ECMAScript.ToInt32(end),arguments.length<1&&(start=0),arguments.length<2&&(end=this.length),0>start&&(start=this.length+start),0>end&&(end=this.length+end),start=clamp(start,0,this.length),end=clamp(end,0,this.length);var len=end-start;return 0>len&&(len=0),new this.constructor(this.buffer,start*this.BYTES_PER_ELEMENT,len)},ctor}ArrayBuffer=function(length){if(length=ECMAScript.ToInt32(length),0>length)throw new RangeError("ArrayBuffer size is not a small enough positive integer.");this.byteLength=length,this._bytes=[],this._bytes.length=length;var i;for(i=0;i<this.byteLength;i+=1)this._bytes[i]=0;configureProperties(this)},ArrayBufferView=function(){},Int8Array=Int8Array||makeTypedArrayConstructor(1,packInt8,unpackInt8),Uint8Array=Uint8Array||makeTypedArrayConstructor(1,packUint8,unpackUint8),Int16Array=Int16Array||makeTypedArrayConstructor(2,packInt16,unpackInt16),Uint16Array=Uint16Array||makeTypedArrayConstructor(2,packUint16,unpackUint16),Int32Array=Int32Array||makeTypedArrayConstructor(4,packInt32,unpackInt32),Uint32Array=Uint32Array||makeTypedArrayConstructor(4,packUint32,unpackUint32),Float32Array=Float32Array||makeTypedArrayConstructor(4,packFloat32,unpackFloat32),Float64Array=Float64Array||makeTypedArrayConstructor(8,packFloat64,unpackFloat64)}(),DataView||function(){function r(array,index){return typeof array.get=="function"?array.get(index):array[index]}function makeDataView_getter(arrayType){return function(byteOffset,littleEndian){byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength&&raise_INDEX_SIZE_ERR(),byteOffset+=this.byteOffset;var uint8Array=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),bytes=[],i;for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(uint8Array,i));return Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),r(new arrayType(new Uint8Array(bytes).buffer),0)}}function makeDataView_setter(arrayType){return function(byteOffset,value,littleEndian){byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength&&raise_INDEX_SIZE_ERR();var typeArray=new arrayType([value]),byteArray=new Uint8Array(typeArray.buffer),bytes=[],i,byteView;for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(byteArray,i));Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),byteView=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),byteView.set(bytes)}}var IS_BIG_ENDIAN=function(){var u16array=new Uint16Array([4660]),u8array=new Uint8Array(u16array.buffer);return r(u8array,0)===18}();DataView=function(buffer,byteOffset,byteLength){if(!("object"==typeof buffer&&buffer instanceof ArrayBuffer))throw new TypeError("TypeError");this.buffer=buffer,this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),this.byteLength=arguments.length<3?this.buffer.byteLength-this.byteOffset:ECMAScript.ToUint32(byteLength),this.byteOffset+this.byteLength>this.buffer.byteLength&&raise_INDEX_SIZE_ERR(),configureProperties(this)},ArrayBufferView&&(DataView.prototype=new ArrayBufferView),DataView.prototype.getUint8=makeDataView_getter(Uint8Array),DataView.prototype.getInt8=makeDataView_getter(Int8Array),DataView.prototype.getUint16=makeDataView_getter(Uint16Array),DataView.prototype.getInt16=makeDataView_getter(Int16Array),DataView.prototype.getUint32=makeDataView_getter(Uint32Array),DataView.prototype.getInt32=makeDataView_getter(Int32Array),DataView.prototype.getFloat32=makeDataView_getter(Float32Array),DataView.prototype.getFloat64=makeDataView_getter(Float64Array),DataView.prototype.setUint8=makeDataView_setter(Uint8Array),DataView.prototype.setInt8=makeDataView_setter(Int8Array),DataView.prototype.setUint16=makeDataView_setter(Uint16Array),DataView.prototype.setInt16=makeDataView_setter(Int16Array),DataView.prototype.setUint32=makeDataView_setter(Uint32Array),DataView.prototype.setInt32=makeDataView_setter(Int32Array),DataView.prototype.setFloat32=makeDataView_setter(Float32Array),DataView.prototype.setFloat64=makeDataView_setter(Float64Array)
}()})(),function(){var BrowserFS,canUsePostMessage,checkFd,handleMessage,makeArrayAccessors,messageName,name,nopCb,startTime,timeouts,value,wrapCb,_ref,_ref1,_ref2,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;if(BrowserFS=function(){function BrowserFS(){}return BrowserFS.node={},BrowserFS.install=function(obj){var oldRequire;return obj.Buffer=BrowserFS.node.Buffer,obj.process=BrowserFS.node.process,oldRequire=obj.require!=null?obj.require:null,obj.require=function(arg,herp){switch(null!=herp&&null==arg&&(arg=herp),arg){case"fs":return BrowserFS.node.fs;case"path":return BrowserFS.node.path;case"process":return BrowserFS.node.process;case"buffer":return BrowserFS.node;default:if(null!=oldRequire)return oldRequire.apply(this,arguments);throw new Error("Module not found: "+arg)}}},BrowserFS.initialize=function(rootfs){return BrowserFS.node.fs._initialize(rootfs)},BrowserFS.util={roughSizeOfObject:function(object){var bytes,key,objectList,prop,stack,value;for(objectList=[],stack=[object],bytes=0;stack.length!==0;)if(value=stack.pop(),"boolean"==typeof value)bytes+=4;else if("string"==typeof value)bytes+=value.length*2;else if("number"==typeof value)bytes+=8;else if("object"==typeof value&&__indexOf.call(objectList,value)<0){objectList.push(value),bytes+=4;for(key in value)prop=value[key],bytes+=key.length*2,stack.push(prop)}return bytes}},BrowserFS.isIE=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase()),BrowserFS}(),BrowserFS.ApiError=function(){function ApiError(type,message){this.type=type,this.message=null!=message?message:""}return ApiError.NETWORK_ERROR=0,ApiError.INVALID_PARAM=400,ApiError.INVALID_TOKEN=401,ApiError.AUTH_ERROR=403,ApiError.NOT_FOUND=404,ApiError.DRIVE_FULL=507,ApiError.NOT_SUPPORTED=405,ApiError.PERMISSIONS_ERROR=900,ApiError.prototype.toString=function(){var typeStr;return typeStr=function(){switch(this.type){case BrowserFS.ApiError.NETWORK_ERROR:return"Network Error";case BrowserFS.ApiError.INVALID_PARAM:return"Invalid Param";case BrowserFS.ApiError.INVALID_TOKEN:return"Invalid Token";case BrowserFS.ApiError.AUTH_ERROR:return"Auth Error";case BrowserFS.ApiError.NOT_FOUND:return"Not Found";case BrowserFS.ApiError.DRIVE_FULL:return"Drive Full";case BrowserFS.ApiError.NOT_SUPPORTED:return"Not Supported";case BrowserFS.ApiError.PERMISSIONS_ERROR:return"Permissions Error";default:return"Error"}}.call(this),"BrowserFS "+typeStr+": "+this.message},ApiError}(),Object.prototype.__defineGetter__&&!Object.defineProperty&&(Object.defineProperty=function(obj,prop,desc){return desc.hasOwnProperty("get")&&obj.__defineGetter__(prop,desc.get),desc.hasOwnProperty("set")?obj.__defineSetter__(prop,desc.set):void 0}),makeArrayAccessors=function(obj){var i,makeArrayAccessor,_i,_ref;if(Object.defineProperty)for(makeArrayAccessor=function(index){return Object.defineProperty(obj,index,{get:function(){return obj.get(index)},set:function(v){return obj.set(index,v)},enumerable:!0,configurable:!1})},i=_i=0,_ref=obj.length;_ref>_i;i=_i+=1)makeArrayAccessor(i)},BrowserFS.node.Buffer=function(){function Buffer(arg1,arg2){var datum,i,rv,_i,_j,_len,_ref;if(null==arg2&&(arg2="utf8"),!(this instanceof BrowserFS.node.Buffer))return new BrowserFS.node.Buffer(arg1,arg2);if(this._charsWritten=0,"number"==typeof arg1){if(arg1!==arg1>>>0)throw new TypeError("Buffer size must be a uint32.");this.length=arg1,this.buff=new DataView(new ArrayBuffer(this.length))}else if(arg1 instanceof DataView)this.buff=arg1,this.length=arg1.byteLength;else if(arg1 instanceof ArrayBuffer)this.buff=new DataView(arg1),this.length=arg1.byteLength;else if(arg1 instanceof BrowserFS.node.Buffer){for(this.buff=new DataView(new ArrayBuffer(arg1.length)),i=_i=0,_ref=arg1.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)this.buff.setUint8(i,arg1.get(i));this.length=arg1.length}else if(Array.isArray(arg1)||arg1[0]!=null&&typeof arg1[0]=="number"){for(this.buff=new DataView(new ArrayBuffer(arg1.length)),i=_j=0,_len=arg1.length;_len>_j;i=_j+=1)datum=arg1[i],this.buff.setUint8(i,datum);this.length=arg1.length}else{if("string"!=typeof arg1)throw new Error("Invalid argument to Buffer constructor: "+arg1);this.length=BrowserFS.node.Buffer.byteLength(arg1,arg2),this.buff=new DataView(new ArrayBuffer(this.length)),rv=this.write(arg1,0,this.length,arg2)}}return Buffer.isEncoding=function(enc){var e;try{BrowserFS.StringUtil.FindUtil(enc)}catch(_error){return e=_error,!1}return!0},Buffer.isBuffer=function(obj){return obj instanceof BrowserFS.node.Buffer},Buffer.byteLength=function(str,encoding){var strUtil;return null==encoding&&(encoding="utf8"),strUtil=BrowserFS.StringUtil.FindUtil(encoding),strUtil.byteLength(str)},Buffer.concat=function(list,totalLength){var buf,curPos,item,_i,_j,_len,_len1;if(list.length===0||0===totalLength)return new BrowserFS.node.Buffer(0);if(list.length===1)return list[0];if(null==totalLength)for(totalLength=0,_i=0,_len=list.length;_len>_i;_i++)item=list[_i],totalLength+=item.length;for(buf=new BrowserFS.node.Buffer(totalLength),curPos=0,_j=0,_len1=list.length;_len1>_j;_j++)item=list[_j],curPos+=item.copy(buf,curPos);return buf},Buffer.prototype.set=function(index,value){return this.buff.setUint8(index,value)},Buffer.prototype.get=function(index){return this.buff.getUint8(index)},Buffer.prototype.write=function(str,offset,length,encoding){var strUtil;return null==offset&&(offset=0),null==length&&(length=this.length),null==encoding&&(encoding="utf8"),"string"==typeof offset?(encoding=offset,offset=0,length=this.length):"string"==typeof length&&(encoding=length,length=this.length),offset>=this.length?0:(strUtil=BrowserFS.StringUtil.FindUtil(encoding),length=length+offset>this.length?this.length-offset:length,strUtil.str2byte(this,str,offset,length))},Buffer.prototype.toString=function(encoding,start,end){var byteArr,i,len,strUtil,_i;if(null==encoding&&(encoding="utf8"),null==start&&(start=0),null==end&&(end=this.length),!(end>=start))throw new Error("Invalid start/end positions: "+start+" - "+end);if(start===end)return"";for(end>this.length&&(end=this.length),strUtil=BrowserFS.StringUtil.FindUtil(encoding),len=end-start,byteArr=new Array(len),i=_i=0;len>_i;i=_i+=1)byteArr[i]=this.readUInt8(start+i);return strUtil.byte2str(byteArr)},Buffer.prototype.toJSON=function(){var arr,i,_i,_ref;for(arr=new Array(this.length),i=_i=0,_ref=this.length;_ref>_i;i=_i+=1)arr[i]=this.buff.getUint8(i);return{type:"Buffer",data:arr}},Buffer.prototype.copy=function(target,targetStart,sourceStart,sourceEnd){var bytesCopied,i,_i;if(null==targetStart&&(targetStart=0),null==sourceStart&&(sourceStart=0),null==sourceEnd&&(sourceEnd=this.length),targetStart=0>targetStart?0:targetStart,sourceStart=0>sourceStart?0:sourceStart,sourceStart>sourceEnd)throw new RangeError("sourceEnd < sourceStart");if(sourceEnd===sourceStart)return 0;if(targetStart>=target.length)throw new RangeError("targetStart out of bounds");if(sourceStart>=this.length)throw new RangeError("sourceStart out of bounds");if(sourceEnd>this.length)throw new RangeError("sourceEnd out of bounds");for(bytesCopied=Math.min(sourceEnd-sourceStart,target.length-targetStart,this.length-sourceStart),i=_i=0;bytesCopied>=0?bytesCopied>_i:_i>bytesCopied;i=bytesCopied>=0?++_i:--_i)target.writeUInt8(this.readUInt8(sourceStart+i),targetStart+i);return bytesCopied},Buffer.prototype.slice=function(start,end){if(null==start&&(start=0),null==end&&(end=this.length),0>start&&(start+=this.length,0>start&&(start=0)),0>end&&(end+=this.length,0>end&&(end=0)),end>this.length&&(end=this.length),start>end&&(start=end),0>start||0>end||start>=this.length||end>this.length)throw new Error("Invalid slice indices.");return new BrowserFS.node.Buffer(new DataView(this.buff.buffer,this.buff.byteOffset+start,end-start))},Buffer.prototype.fill=function(value,offset,end){var i,num32,remSt,val32,valType,_i,_j;switch(null==offset&&(offset=0),null==end&&(end=this.length),valType=typeof value){case"string":value=value.charCodeAt(0)&255;break;case"number":break;default:throw new Error("Invalid argument to fill.")}for(val32=value|value<<8|value<<16|value<<24,num32=Math.floor((end-offset)/4),remSt=offset+4*num32,i=_i=0;num32>=0?num32>_i:_i>num32;i=num32>=0?++_i:--_i)this.writeUInt32LE(val32,offset+4*i);for(i=_j=remSt;end>=remSt?end>_j:_j>end;i=end>=remSt?++_j:--_j)this.writeUInt8(value,i)},Buffer.prototype.readUInt8=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getUint8(offset)},Buffer.prototype.readUInt16LE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getUint16(offset,!0)},Buffer.prototype.readUInt16BE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getUint16(offset,!1)},Buffer.prototype.readUInt32LE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getUint32(offset,!0)},Buffer.prototype.readUInt32BE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getUint32(offset,!1)},Buffer.prototype.readInt8=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getInt8(offset)},Buffer.prototype.readInt16LE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getInt16(offset,!0)},Buffer.prototype.readInt16BE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getInt16(offset,!1)},Buffer.prototype.readInt32LE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getInt32(offset,!0)},Buffer.prototype.readInt32BE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getInt32(offset,!1)},Buffer.prototype.readFloatLE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getFloat32(offset,!0)},Buffer.prototype.readFloatBE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getFloat32(offset,!1)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getFloat64(offset,!0)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.getFloat64(offset,!1)},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setUint8(offset,value)},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setUint16(offset,value,!0)},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setUint16(offset,value,!1)},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setUint32(offset,value,!0)},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setUint32(offset,value,!1)},Buffer.prototype.writeInt8=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setInt8(offset,value)},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setInt16(offset,value,!0)},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setInt16(offset,value,!1)},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setInt32(offset,value,!0)},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setInt32(offset,value,!1)},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setFloat32(offset,value,!0)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setFloat32(offset,value,!1)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setFloat64(offset,value,!0)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return null==noAssert&&(noAssert=!1),this.buff.setFloat64(offset,value,!1)},Buffer}(),BrowserFS.File=function(){function File(){}return File.prototype.getPos=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.stat=function(cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.statSync=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.close=function(cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.closeSync=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.truncate=function(len,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.truncateSync=function(len){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.sync=function(cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.syncSync=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.write=function(buffer,offset,length,position,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.writeSync=function(buffer,offset,length,position){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.read=function(buffer,offset,length,position,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.readSync=function(buffer,offset,length,position){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.datasync=function(cb){return this.sync(cb)},File.prototype.datasyncSync=function(){return this.syncSync()},File.prototype.chown=function(uid,gid,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.chownSync=function(uid,gid){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.chmod=function(mode,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.chmodSync=function(mode){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File.prototype.utimes=function(atime,mtime,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},File.prototype.utimesSync=function(atime,mtime){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},File}(),BrowserFS.FileSystem=function(){function FileSystem(){}return FileSystem.prototype.getName=function(){return"Unspecified"},FileSystem.isAvailable=function(){return!1},FileSystem.prototype.diskSpace=function(path,cb){return cb(0,0)},FileSystem.prototype.isReadOnly=function(){return!0},FileSystem.prototype.supportsLinks=function(){return!1},FileSystem.prototype.supportsProps=function(){return!1},FileSystem.prototype.supportsSynch=function(){return!1},FileSystem.prototype.rename=function(oldPath,newPath,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.renameSync=function(oldPath,newPath){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.stat=function(path,isLstat,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.statSync=function(path,isLstat){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.open=function(path,flags,mode,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.openSync=function(path,flags,mode){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.unlink=function(path,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.unlinkSync=function(path){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.rmdir=function(path,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.rmdirSync=function(path){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.mkdir=function(path,mode,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.mkdirSync=function(path,mode){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.readdir=function(path,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.readdirSync=function(path){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.exists=function(path,cb){return this.stat(path,null,function(err){return cb(null==err)})},FileSystem.prototype.existsSync=function(path){var e;try{return this.statSync(path),!0}catch(_error){return e=_error,!1}},FileSystem.prototype.realpath=function(path,cache,cb){var addPaths,i,splitPath,_i,_ref,_results;if(this.supportsLinks()){for(splitPath=path.split(BrowserFS.node.path.sep),_results=[],i=_i=0,_ref=splitPath.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)addPaths=splitPath.slice(0,i+1),_results.push(splitPath[i]=BrowserFS.node.path.join.apply(null,addPaths));return _results}return this.exists(path,function(doesExist){return doesExist?cb(null,path):cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,"File "+path+" not found."))})},FileSystem.prototype.realpathSync=function(path,cache){var addPaths,i,splitPath,_i,_ref,_results;if(this.supportsLinks()){for(splitPath=path.split(BrowserFS.node.path.sep),_results=[],i=_i=0,_ref=splitPath.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)addPaths=splitPath.slice(0,i+1),_results.push(splitPath[i]=BrowserFS.node.path.join.apply(null,addPaths));return _results}if(this.existsSync(path))return path;throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,"File "+path+" not found.")},FileSystem.prototype.truncate=function(path,len,cb){return BrowserFS.node.fs.open(path,"w",function(er,fd){return er?cb(er):BrowserFS.node.fs.ftruncate(fd,len,function(er){return BrowserFS.node.fs.close(fd,function(er2){return cb(er||er2)})})})},FileSystem.prototype.truncateSync=function(path,len){var e,fd;fd=BrowserFS.node.fs.openSync(path,"w");try{BrowserFS.node.fs.ftruncateSync(fd,len)}catch(_error){e=_error}if(BrowserFS.node.fs.closeSync(fd),null!=e)throw e},FileSystem.prototype.readFile=function(fname,encoding,flag,cb){var oldCb;return oldCb=cb,this.open(fname,flag,420,function(err,fd){return null!=err?cb(err):(cb=function(err,arg){return fd.close(function(err2){return null==err&&(err=err2),oldCb(err,arg)})},BrowserFS.node.fs.fstat(fd,function(err,stat){var buf;return null!=err?cb(err):(buf=new BrowserFS.node.Buffer(stat.size),BrowserFS.node.fs.read(fd,buf,0,stat.size,0,function(err){var e;if(null!=err)return cb(err);if(null===encoding)return cb(err,buf);try{return cb(null,buf.toString(encoding))}catch(_error){return e=_error,cb(e)}}))}))})},FileSystem.prototype.readFileSync=function(fname,encoding,flag){var buf,e,fd,stat;fd=this.openSync(fname,flag,420);try{return stat=BrowserFS.node.fs.fstatSync(fd),buf=new BrowserFS.node.Buffer(stat.size),BrowserFS.node.fs.readSync(fd,buf,0,stat.size,0),BrowserFS.node.fs.closeSync(fd),null===encoding?buf:buf.toString(encoding)}catch(_error){throw e=_error,BrowserFS.node.fs.closeSync(fd),e}},FileSystem.prototype.writeFile=function(fname,data,encoding,flag,mode,cb){var oldCb;return oldCb=cb,this.open(fname,flag,420,function(err,fd){return null!=err?cb(err):(cb=function(err){return fd.close(function(err2){return oldCb(null!=err?err:err2)})},"string"==typeof data&&(data=new BrowserFS.node.Buffer(data,encoding)),fd.write(data,0,data.length,0,function(err){return cb(err)}))})},FileSystem.prototype.writeFileSync=function(fname,data,encoding,flag,mode){var e,fd;fd=this.openSync(fname,flag,mode),"string"==typeof data&&(data=new BrowserFS.node.Buffer(data,encoding));try{fd.writeSync(data,0,data.length,0)}catch(_error){e=_error}if(BrowserFS.node.fs.closeSync(fd),null!=e)throw e},FileSystem.prototype.appendFile=function(fname,data,encoding,flag,mode,cb){var oldCb;return oldCb=cb,this.open(fname,flag,mode,function(err,fd){return null!=err&&cb(err),cb=function(err){return fd.close(function(err2){return oldCb(null!=err?err:err2)})},"string"==typeof data&&(data=new BrowserFS.node.Buffer(data,encoding)),fd.write(data,0,data.length,null,function(err){return cb(err)})})},FileSystem.prototype.appendFileSync=function(fname,data,encoding,flag,mode){var e,fd;fd=this.openSync(fname,flag,mode),"string"==typeof data&&(data=new BrowserFS.node.Buffer(data,encoding));try{fd.writeSync(data,0,data.length,null)}catch(_error){e=_error}if(BrowserFS.node.fs.closeSync(fd),null!=e)throw e},FileSystem.prototype.chmod=function(path,isLchmod,mode,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.chmodSync=function(path,isLchmod,mode){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.chown=function(path,isLchown,uid,gid,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.chownSync=function(path,isLchown,uid,gid){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.utimes=function(path,atime,mtime,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.utimesSync=function(path,atime,mtime){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.link=function(srcpath,dstpath,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.linkSync=function(srcpath,dstpath){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.symlink=function(srcpath,dstpath,type,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.symlinkSync=function(srcpath,dstpath,type){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem.prototype.readlink=function(path,cb){return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED))},FileSystem.prototype.readlinkSync=function(path){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},FileSystem}(),BrowserFS.SynchronousFileSystem=function(_super){function SynchronousFileSystem(){return _ref=SynchronousFileSystem.__super__.constructor.apply(this,arguments)}return __extends(SynchronousFileSystem,_super),SynchronousFileSystem.prototype.supportsSynch=function(){return!0},SynchronousFileSystem.prototype.rename=function(oldPath,newPath,cb){var e;try{return this.renameSync(oldPath,newPath),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.stat=function(path,isLstat,cb){var e;try{return cb(null,this.statSync(path,isLstat))}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.open=function(path,flags,mode,cb){var e;try{return cb(null,this.openSync(path,flags,mode,cb))}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.unlink=function(path,cb){var e;try{return this.unlinkSync(path),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.rmdir=function(path,cb){var e;try{return this.rmdirSync(path),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.mkdir=function(path,mode,cb){var e;try{return this.mkdirSync(path,mode),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.readdir=function(path,cb){var e;try{return cb(null,this.readdirSync(path))}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.chmod=function(path,isLchmod,mode,cb){var e;try{return this.chmodSync(path,isLchmod,mode),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.chown=function(path,isLchown,uid,gid,cb){var e;try{return this.chownSync(path,isLchown,uid,gid),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.utimes=function(path,atime,mtime,cb){var e;try{return this.utimesSync(path,atime,mtime),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.link=function(srcpath,dstpath,cb){var e;try{return this.linkSync(srcpath,dstpath),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.symlink=function(srcpath,dstpath,type,cb){var e;try{return this.symlinkSync(srcpath,dstpath,type),cb()}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem.prototype.readlink=function(path,cb){var e;try{return cb(null,this.readlinkSync(path))}catch(_error){return e=_error,cb(e)}},SynchronousFileSystem}(BrowserFS.FileSystem),wrapCb=function(cb,numArgs){if("function"!=typeof cb)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Callback must be a function.");switch(typeof window.__numWaiting===void 0&&(window.__numWaiting=0),window.__numWaiting++,numArgs){case 1:return function(arg1){return setImmediate(function(){return window.__numWaiting--,cb(arg1)})};case 2:return function(arg1,arg2){return setImmediate(function(){return window.__numWaiting--,cb(arg1,arg2)})};case 3:return function(arg1,arg2,arg3){return setImmediate(function(){return window.__numWaiting--,cb(arg1,arg2,arg3)})};default:throw new Error("Invalid invocation of wrapCb.")}},checkFd=function(fd,async){if(null==async&&(async=!0),!(fd instanceof BrowserFS.File)){if(async)return new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid file descriptor.");throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid file descriptor.")}return!0},nopCb=function(){},BrowserFS.node.fs=function(){function fs(){}return fs._initialize=function(rootFS){if(!rootFS.constructor.isAvailable())throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Tried to instantiate BrowserFS with an unavailable file system.");return fs.root=rootFS},fs._toUnixTimestamp=function(time){if("number"==typeof time)return time;if(time instanceof Date)return time.getTime()/1e3;throw new Error("Cannot parse time: "+time)},fs.getRootFS=function(){return fs.root?fs.root:null},fs._canonicalizePath=function(p){if(p.indexOf("\0")>=0)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Path must be a string without null bytes.");return""===p?p:BrowserFS.node.path.resolve(p)},fs.rename=function(oldPath,newPath,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),oldPath=fs._canonicalizePath(oldPath),newPath=fs._canonicalizePath(newPath),fs.root.rename(oldPath,newPath,newCb)}catch(_error){return e=_error,newCb(e)}},fs.renameSync=function(oldPath,newPath){return oldPath=fs._canonicalizePath(oldPath),newPath=fs._canonicalizePath(newPath),fs.root.renameSync(oldPath,newPath)},fs.exists=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),fs.root.exists(path,newCb)}catch(_error){return e=_error,newCb(!1)}},fs.existsSync=function(path){var e;try{return path=fs._canonicalizePath(path),fs.root.existsSync(path)}catch(_error){return e=_error,!1}},fs.stat=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),fs.root.stat(path,!1,newCb)}catch(_error){return e=_error,newCb(e)}},fs.statSync=function(path){return path=fs._canonicalizePath(path),fs.root.statSync(path,!1)},fs.lstat=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),fs.root.stat(path,!0,newCb)}catch(_error){return e=_error,newCb(e)}},fs.lstatSync=function(path){return path=fs._canonicalizePath(path),fs.root.statSync(path,!0)},fs.truncate=function(path,len,callback){var e,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof len&&(callback=len,len=0),newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),fs.root.truncate(path,len,newCb)}catch(_error){return e=_error,newCb(e)}},fs.truncateSync=function(path,len){return null==len&&(len=0),path=fs._canonicalizePath(path),fs.root.truncateSync(path,len)},fs.unlink=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),fs.root.unlink(path,newCb)}catch(_error){return e=_error,newCb(e)}},fs.unlinkSync=function(path){return path=fs._canonicalizePath(path),fs.root.unlinkSync(path)},fs.open=function(path,flags,mode,callback){var e,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof mode&&(callback=mode,mode=420),newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),flags=BrowserFS.FileMode.getFileMode(flags),fs.root.open(path,flags,mode,newCb)}catch(_error){return e=_error,newCb(e)}},fs.openSync=function(path,flags,mode){return null==mode&&(mode=420),path=fs._canonicalizePath(path),flags=BrowserFS.FileMode.getFileMode(flags),fs.root.openSync(path,flags,mode)},fs.readFile=function(filename,options,callback){var e,flags,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof options?(callback=options,options={}):"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding=null),options.flag==null&&(options.flag="r"),newCb=wrapCb(callback,2),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),flags.isReadable()?fs.root.readFile(filename,options.encoding,flags,newCb):newCb(new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to readFile must allow for reading."))}catch(_error){return e=_error,newCb(e)}},fs.readFileSync=function(filename,options){var flags;if(null==options&&(options={}),"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding=null),options.flag==null&&(options.flag="r"),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),!flags.isReadable())throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to readFile must allow for reading.");return fs.root.readFileSync(filename,options.encoding,flags)},fs.writeFile=function(filename,data,options,callback){var e,flags,newCb;null==options&&(options={}),null==callback&&(callback=nopCb);try{return"function"==typeof options?(callback=options,options={}):"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding="utf8"),options.flag==null&&(options.flag="w"),options.mode==null&&(options.mode=420),newCb=wrapCb(callback,1),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),flags.isWriteable()?fs.root.writeFile(filename,data,options.encoding,flags,options.mode,newCb):newCb(new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to writeFile must allow for writing."))}catch(_error){return e=_error,newCb(e)}},fs.writeFileSync=function(filename,data,options){var flags;if(null==options&&(options={}),"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding="utf8"),options.flag==null&&(options.flag="w"),options.mode==null&&(options.mode=420),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),!flags.isWriteable())throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to writeFile must allow for writing.");return fs.root.writeFileSync(filename,data,options.encoding,flags,options.mode)},fs.appendFile=function(filename,data,options,callback){var e,flags,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof options?(callback=options,options={}):"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding="utf8"),options.flag==null&&(options.flag="a"),options.mode==null&&(options.mode=420),newCb=wrapCb(callback,1),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),flags.isAppendable()?fs.root.appendFile(filename,data,options.encoding,flags,options.mode,newCb):newCb(new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to appendFile must allow for appending."))
}catch(_error){return e=_error,newCb(e)}},fs.appendFileSync=function(filename,data,options){var flags;if(null==options&&(options={}),"string"==typeof options&&(options={encoding:options}),void 0===options&&(options={}),options.encoding===void 0&&(options.encoding="utf8"),options.flag==null&&(options.flag="a"),options.mode==null&&(options.mode=420),filename=fs._canonicalizePath(filename),flags=BrowserFS.FileMode.getFileMode(options.flag),!flags.isAppendable())throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Flag passed to appendFile must allow for appending.");return fs.root.appendFileSync(filename,data,options.encoding,flags,options.mode)},fs.fstat=function(fd,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,2),fdChk=checkFd(fd),fdChk?fd.stat(newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.fstatSync=function(fd){return checkFd(fd,!1),fd.statSync()},fs.close=function(fd,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),fdChk=checkFd(fd),fdChk?fd.close(newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.closeSync=function(fd){return checkFd(fd,!1),fd.closeSync()},fs.ftruncate=function(fd,len,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof len&&(callback=len,len=0),newCb=wrapCb(callback,1),fdChk=checkFd(fd),fdChk?fd.truncate(len,newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.ftruncateSync=function(fd,len){return null==len&&(len=0),checkFd(fd,!1),fd.truncateSync(len)},fs.fsync=function(fd,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),fdChk=checkFd(fd),fdChk?fd.sync(newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.fsyncSync=function(fd){return checkFd(fd,!1),fd.syncSync()},fs.fdatasync=function(fd,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),fdChk=checkFd(fd),fdChk?fd.datasync(newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.fdatasyncSync=function(fd){checkFd(fd,!1),fd.datasyncSync()},fs.write=function(fd,buffer,offset,length,position,callback){var e,encoding,fdChk,newCb;try{return"string"==typeof buffer&&("function"==typeof position&&(callback=position,encoding=length,position=offset,offset=0),buffer=new Buffer(buffer,encoding),length=buffer.length),null==callback&&(callback=position,position=fd.getPos()),newCb=wrapCb(callback,3),(fdChk=checkFd(fd))?(null==position&&(position=fd.getPos()),fd.write(buffer,offset,length,position,newCb)):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.writeSync=function(fd,buffer,offset,length,position){var encoding;return"string"==typeof buffer&&("string"==typeof length?encoding=length:"string"==typeof offset?encoding=offset:"number"==typeof offset&&(position=offset),offset=0,buffer=new Buffer(buffer,encoding),length=buffer.length),checkFd(fd,!1),null==position&&(position=fd.getPos()),fd.writeSync(buffer,offset,length,position)},fs.read=function(fd,buffer,offset,length,position,callback){var e,encoding,fdChk,newCb;null==callback&&(callback=nopCb);try{return"number"==typeof buffer&&"number"==typeof offset&&"string"==typeof length&&"function"==typeof position?(callback=position,position=offset,offset=0,encoding=length,length=buffer,buffer=new BrowserFS.node.Buffer(length),newCb=wrapCb(function(err,bytesRead,buf){return err?oldNewCb(err):callback(err,buf.toString(encoding),bytesRead)},3)):newCb=wrapCb(callback,3),(fdChk=checkFd(fd))?(null==position&&(position=fd.getPos()),fd.read(buffer,offset,length,position,newCb)):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.readSync=function(fd,buffer,offset,length,position){var encoding,rv,shenanigans;return shenanigans=!1,"number"==typeof buffer&&"number"==typeof offset&&"string"==typeof length&&(position=offset,offset=0,encoding=length,length=buffer,buffer=new BrowserFS.node.Buffer(length),shenanigans=!0),checkFd(fd,!1),null==position&&(position=fd.getPos()),rv=fd.readSync(buffer,offset,length,position),shenanigans?[buffer.toString(encoding),rv]:rv},fs.fchown=function(fd,uid,gid,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),fdChk=checkFd(fd),fdChk?fd.chown(uid,gid,newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.fchownSync=function(fd,uid,gid){return checkFd(fd,!1),fd.chownSync(uid,gid)},fs.fchmod=function(fd,mode,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),"string"==typeof mode&&(mode=parseInt(mode,8)),fdChk=checkFd(fd),fdChk?fd.chmod(mode,newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.fchmodSync=function(fd,mode){return"string"==typeof mode&&(mode=parseInt(mode,8)),checkFd(fd,!1),fd.chmodSync(mode)},fs.futimes=function(fd,atime,mtime,callback){var e,fdChk,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),fdChk=checkFd(fd),"number"==typeof atime&&(atime=new Date(1e3*atime)),"number"==typeof mtime&&(mtime=new Date(1e3*mtime)),fdChk?fd.utimes(atime,mtime,newCb):newCb(fdChk)}catch(_error){return e=_error,newCb(e)}},fs.futimesSync=function(fd,atime,mtime){return checkFd(fd,!1),"number"==typeof atime&&(atime=new Date(1e3*atime)),"number"==typeof mtime&&(mtime=new Date(1e3*mtime)),fd.utimesSync(atime,mtime)},fs.rmdir=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),BrowserFS.node.fs.root.rmdir(path,newCb)}catch(_error){return e=_error,newCb(e)}},fs.rmdirSync=function(path){return path=fs._canonicalizePath(path),BrowserFS.node.fs.root.rmdirSync(path)},fs.mkdir=function(path,mode,callback){var e,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof mode&&(callback=mode,mode=511),newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),BrowserFS.node.fs.root.mkdir(path,mode,newCb)}catch(_error){return e=_error,newCb(e)}},fs.mkdirSync=function(path,mode){return null==mode&&(mode=511),path=fs._canonicalizePath(path),BrowserFS.node.fs.root.mkdirSync(path,mode)},fs.readdir=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),fs.root.readdir(path,newCb)}catch(_error){return e=_error,newCb(e)}},fs.readdirSync=function(path){return path=fs._canonicalizePath(path),fs.root.readdirSync(path)},fs.link=function(srcpath,dstpath,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),srcpath=fs._canonicalizePath(srcpath),dstpath=fs._canonicalizePath(dstpath),fs.root.link(srcpath,dstpath,newCb)}catch(_error){return e=_error,newCb(e)}},fs.linkSync=function(srcpath,dstpath){return srcpath=fs._canonicalizePath(srcpath),dstpath=fs._canonicalizePath(dstpath),fs.root.linkSync(srcpath,dstpath)},fs.symlink=function(srcpath,dstpath,type,callback){var e,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof type&&(callback=type,type="file"),newCb=wrapCb(callback,1),"file"!==type&&"dir"!==type?newCb(new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid type: "+type)):(srcpath=fs._canonicalizePath(srcpath),dstpath=fs._canonicalizePath(dstpath),fs.root.symlink(srcpath,dstpath,type,newCb))}catch(_error){return e=_error,newCb(e)}},fs.symlink=function(srcpath,dstpath,type){if(null==type&&(type="file"),"file"!==type&&"dir"!==type)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid type: "+type);return srcpath=fs._canonicalizePath(srcpath),dstpath=fs._canonicalizePath(dstpath),fs.root.symlinkSync(srcpath,dstpath,type)},fs.readlink=function(path,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),fs.root.readlink(path,newCb)}catch(_error){return e=_error,newCb(e)}},fs.readlinkSync=function(path){return path=fs._canonicalizePath(path),fs.root.readlinkSync(path)},fs.chown=function(path,uid,gid,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),fs.root.chown(path,!1,uid,gid,newCb)}catch(_error){return e=_error,newCb(e)}},fs.chownSync=function(path,uid,gid){return path=fs._canonicalizePath(path),fs.root.chownSync(path,!1,uid,gid)},fs.lchown=function(path,uid,gid,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),fs.root.chown(path,!0,uid,gid,newCb)}catch(_error){return e=_error,newCb(e)}},fs.lchownSync=function(path,uid,gid){return path=fs._canonicalizePath(path),fs.root.chownSync(path,!0,uid,gid)},fs.chmod=function(path,mode,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),"string"==typeof mode&&(mode=parseInt(mode,8)),path=fs._canonicalizePath(path),fs.root.chmod(path,!1,mode,newCb)}catch(_error){return e=_error,newCb(e)}},fs.chmodSync=function(path,mode){return"string"==typeof mode&&(mode=parseInt(mode,8)),path=fs._canonicalizePath(path),fs.root.chmodSync(path,!1,mode)},fs.lchmod=function(path,mode,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),"string"==typeof mode&&(mode=parseInt(mode,8)),path=fs._canonicalizePath(path),fs.root.chmod(path,!0,mode,newCb)}catch(_error){return e=_error,newCb(e)}},fs.lchmodSync=function(path,mode){return path=fs._canonicalizePath(path),"string"==typeof mode&&(mode=parseInt(mode,8)),fs.root.chmodSync(path,!0,mode)},fs.utimes=function(path,atime,mtime,callback){var e,newCb;null==callback&&(callback=nopCb);try{return newCb=wrapCb(callback,1),path=fs._canonicalizePath(path),"number"==typeof atime&&(atime=new Date(1e3*atime)),"number"==typeof mtime&&(mtime=new Date(1e3*mtime)),fs.root.utimes(path,atime,mtime,newCb)}catch(_error){return e=_error,newCb(e)}},fs.utimesSync=function(path,atime,mtime){return path=fs._canonicalizePath(path),"number"==typeof atime&&(atime=new Date(1e3*atime)),"number"==typeof mtime&&(mtime=new Date(1e3*mtime)),fs.root.utimesSync(path,atime,mtime)},fs.realpath=function(path,cache,callback){var e,newCb;null==callback&&(callback=nopCb);try{return"function"==typeof cache&&(callback=cache,cache={}),newCb=wrapCb(callback,2),path=fs._canonicalizePath(path),fs.root.realpath(path,cache,newCb)}catch(_error){return e=_error,newCb(e)}},fs.realpathSync=function(path,cache){return null==cache&&(cache={}),path=fs._canonicalizePath(path),fs.root.realpathSync(path,cache)},fs}.call(this),BrowserFS.FileMode=function(){function FileMode(modeStr){if(this.modeStr=modeStr,__indexOf.call(BrowserFS.FileMode.validModeStrs,modeStr)<0)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid mode string: "+modeStr)}return FileMode.modeCache={},FileMode.validModeStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"],FileMode.getFileMode=function(modeStr){var fm;return __indexOf.call(FileMode.modeCache,modeStr)>=0?FileMode.modeCache[modeStr]:(fm=new BrowserFS.FileMode(modeStr),FileMode.modeCache[modeStr]=fm,fm)},FileMode.NOP=0,FileMode.THROW_EXCEPTION=1,FileMode.TRUNCATE_FILE=2,FileMode.CREATE_FILE=3,FileMode.prototype.isReadable=function(){return this.modeStr.indexOf("r")!==-1||this.modeStr.indexOf("+")!==-1},FileMode.prototype.isWriteable=function(){return this.modeStr.indexOf("w")!==-1||this.modeStr.indexOf("a")!==-1||this.modeStr.indexOf("+")!==-1},FileMode.prototype.isTruncating=function(){return this.modeStr.indexOf("w")!==-1},FileMode.prototype.isAppendable=function(){return this.modeStr.indexOf("a")!==-1},FileMode.prototype.isSynchronous=function(){return this.modeStr.indexOf("s")!==-1},FileMode.prototype.isExclusive=function(){return this.modeStr.indexOf("x")!==-1},FileMode.prototype.pathExistsAction=function(){return this.isExclusive()?BrowserFS.FileMode.THROW_EXCEPTION:this.isTruncating()?BrowserFS.FileMode.TRUNCATE_FILE:BrowserFS.FileMode.NOP},FileMode.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.modeStr!=="r+"?BrowserFS.FileMode.CREATE_FILE:BrowserFS.FileMode.THROW_EXCEPTION},FileMode}.call(this),BrowserFS.node.fs.Stats=function(){function Stats(item_type,size,mode,atime,mtime,ctime){this.item_type=item_type,this.size=size,this.mode=null!=mode?mode:420,this.atime=null!=atime?atime:new Date,this.mtime=null!=mtime?mtime:new Date,this.ctime=null!=ctime?ctime:new Date,this.blocks=Math.ceil(size/512),this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0}return Stats.FILE=1,Stats.DIRECTORY=2,Stats.SYMLINK=3,Stats.SOCKET=4,Stats.prototype.clone=function(){return new BrowserFS.node.fs.Stats(this.item_type,this.size,this.mode,this.atime,this.mtime,this.ctime)},Stats.prototype.isFile=function(){return this.item_type===Stats.FILE},Stats.prototype.isDirectory=function(){return this.item_type===Stats.DIRECTORY},Stats.prototype.isSymbolicLink=function(){return this.item_type===Stats.SYMLINK},Stats.prototype.isSocket=function(){return this.item_type===Stats.SOCKET},Stats.prototype.isBlockDevice=function(){return!0},Stats.prototype.isCharacterDevice=function(){return!1},Stats.prototype.isFIFO=function(){return!1},Stats}(),BrowserFS.node.path=function(){function path(){}return path.normalize=function(p){var absolute,c,components,goodComponents,idx,_i,_len;for(""===p&&(p="."),absolute=p.charAt(0)===path.sep,p=path._removeDuplicateSeps(p),components=p.split(path.sep),goodComponents=[],idx=_i=0,_len=components.length;_len>_i;idx=++_i)c=components[idx],"."!==c&&(".."===c&&(absolute||!absolute&&goodComponents.length>0&&goodComponents[0]!=="..")?goodComponents.pop():goodComponents.push(c));if(!absolute&&goodComponents.length<2)switch(goodComponents.length){case 1:goodComponents[0]===""&&goodComponents.unshift(".");break;default:goodComponents.push(".")}return p=goodComponents.join(path.sep),absolute&&p.charAt(0)!==path.sep&&(p=path.sep+p),p},path.join=function(){var paths,processed,segment,_i,_len;for(paths=1<=arguments.length?__slice.call(arguments,0):[],processed=[],_i=0,_len=paths.length;_len>_i;_i++){if(segment=paths[_i],"string"!=typeof segment)throw new TypeError("Invalid argument type to path.join: "+typeof segment);""!==segment&&processed.push(segment)}return path.normalize(processed.join(path.sep))},path.resolve=function(){var cwd,p,paths,processed,resolved,_i,_len;for(paths=1<=arguments.length?__slice.call(arguments,0):[],processed=[],_i=0,_len=paths.length;_len>_i;_i++){if(p=paths[_i],"string"!=typeof p)throw new TypeError("Invalid argument type to path.join: "+typeof p);""!==p&&(p.charAt(0)===path.sep&&(processed=[]),processed.push(p))}return resolved=path.normalize(processed.join(path.sep)),resolved.length>1&&resolved.charAt(resolved.length-1)===path.sep?resolved.substr(0,resolved.length-1):(resolved.charAt(0)!==path.sep&&(resolved.charAt(0)!=="."||resolved.length!==1&&resolved.charAt(1)!==path.sep||(resolved=resolved.length===1?"":resolved.substr(2)),cwd=BrowserFS.node.process.cwd(),resolved=""!==resolved?BrowserFS.node.path.normalize(cwd+("/"!==cwd?path.sep:"")+resolved):cwd),resolved)},path.relative=function(from,to){var downSegs,fromSegs,i,rv,seg,toSegs,upCount,_i,_j,_len;for(from=path.resolve(from),to=path.resolve(to),fromSegs=from.split(path.sep),toSegs=to.split(path.sep),toSegs.shift(),fromSegs.shift(),upCount=0,downSegs=[],i=_i=0,_len=fromSegs.length;_len>_i;i=++_i)if(seg=fromSegs[i],seg!==toSegs[i]){upCount=fromSegs.length-i;break}for(downSegs=toSegs.slice(i),fromSegs.length===1&&fromSegs[0]===""&&(upCount=0),upCount>fromSegs.length&&(upCount=fromSegs.length),rv="",i=_j=0;upCount>=0?upCount>_j:_j>upCount;i=upCount>=0?++_j:--_j)rv+="../";return rv+=downSegs.join(path.sep),rv.length>1&&rv.charAt(rv.length-1)===path.sep&&(rv=rv.substr(0,rv.length-1)),rv},path.dirname=function(p){var absolute,sections;return p=path._removeDuplicateSeps(p),absolute=p.charAt(0)===path.sep,sections=p.split(path.sep),sections.pop()===""&&sections.length>0&&sections.pop(),sections.length>1?sections.join(path.sep):absolute?path.sep:"."},path.basename=function(p,ext){var lastPart,lastPartExt,sections;return null==ext&&(ext=""),""===p?p:(p=path.normalize(p),sections=p.split(path.sep),lastPart=sections[sections.length-1],""===lastPart&&sections.length>1?sections[sections.length-2]:ext.length>0&&(lastPartExt=lastPart.substr(lastPart.length-ext.length),lastPartExt===ext)?lastPart.substr(0,lastPart.length-ext.length):lastPart)},path.extname=function(p){var i,sections;return p=path.normalize(p),sections=p.split(path.sep),p=sections.pop(),""===p&&sections.length>0&&(p=sections.pop()),".."===p?"":(i=p.lastIndexOf("."),-1===i||0===i?"":p.substr(i))},path.isAbsolute=function(p){return p.length>0&&p.charAt(0)===path.sep},path._makeLong=function(p){return p},path.sep="/",path._replaceRegex=new RegExp("//+","g"),path._removeDuplicateSeps=function(p){return p=p.replace(this._replaceRegex,this.sep)},path.delimiter=":",path}.call(this),startTime=Date.now(),BrowserFS.node.process=function(){function process(){}return process._cwd="/",process.chdir=function(dir){return this._cwd=BrowserFS.node.path.resolve(dir)},process.cwd=function(){return this._cwd},process.platform=function(){return"browser"},process.uptime=function(){return(Date.now()-startTime)/1e3|0},process}(),"undefined"==typeof setImmediate&&(timeouts=[],messageName="zero-timeout-message",canUsePostMessage=function(){var oldOnMessage,postMessageIsAsync;return window.postMessage?(postMessageIsAsync=!0,oldOnMessage=window.onmessage,window.onmessage=function(){return postMessageIsAsync=!1},window.postMessage("","*"),window.onmessage=oldOnMessage,postMessageIsAsync):!1},canUsePostMessage()?(window.setImmediate=function(fn){return timeouts.push(fn),window.postMessage(messageName,"*")},handleMessage=function(event){var fn;return event.source===self&&event.data===messageName&&(event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,timeouts.length>0)?(fn=timeouts.shift(),fn()):void 0},window.addEventListener?window.addEventListener("message",handleMessage,!0):window.attachEvent("onmessage",handleMessage)):window.setImmediate=function(fn){var scriptEl;return setTimeout(fn,0)}),BrowserFS.StringUtil=function(){function StringUtil(){}return StringUtil.FindUtil=function(encoding){switch(encoding=function(){switch(typeof encoding){case"object":return""+encoding;case"string":return encoding;default:throw new Error("Invalid encoding argument specified")}}(),encoding=encoding.toLowerCase()){case"utf8":case"utf-8":return BrowserFS.StringUtil.UTF8;case"ascii":case"binary":return BrowserFS.StringUtil.ASCII;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return BrowserFS.StringUtil.UCS2;case"hex":return BrowserFS.StringUtil.HEX;case"base64":return BrowserFS.StringUtil.BASE64;case"binary_string":return BrowserFS.StringUtil.BINSTR;case"binary_string_ie":return BrowserFS.StringUtil.BINSTRIE;default:throw new Error("Unknown encoding: "+encoding)}},StringUtil}(),BrowserFS.StringUtil.UTF8=function(){function UTF8(){}return UTF8.str2byte=function(buf,str,offset,length){var code,codePoint,i,j,maxJ,next,numChars,rv;for(i=0,j=offset,maxJ=offset+length,rv=[],numChars=0;i<str.length&&maxJ>j;)if(code=str.charCodeAt(i++),next=str.charCodeAt(i),code>=55296&&56319>=code&&next>=56320&&57343>=next){if(j+3>=maxJ)break;numChars++,codePoint=(1024|1023&code)<<10|1023&next,buf.writeUInt8(240|codePoint>>18,j++),buf.writeUInt8(128|63&codePoint>>12,j++),buf.writeUInt8(128|63&codePoint>>6,j++),buf.writeUInt8(128|63&codePoint,j++),i++}else if(128>code)buf.writeUInt8(code,j++),numChars++;else if(2048>code){if(j+1>=maxJ)break;numChars++,buf.writeUInt8(192|code>>6,j++),buf.writeUInt8(128|63&code,j++)}else if(65536>code){if(j+2>=maxJ)break;numChars++,buf.writeUInt8(224|code>>12,j++),buf.writeUInt8(128|63&code>>6,j++),buf.writeUInt8(128|63&code,j++)}return buf._charsWritten=numChars,j-offset},UTF8.byte2str=function(byteArray){var byte3,chars,code,i;for(chars=[],i=0;i<byteArray.length;)if(code=byteArray[i++],128>code)chars.push(String.fromCharCode(code));else{if(192>code)throw new Error("Found incomplete part of character in string.");if(224>code)chars.push(String.fromCharCode((31&code)<<6|byteArray[i++]&63));else if(240>code)chars.push(String.fromCharCode((15&code)<<12|(byteArray[i++]&63)<<6|byteArray[i++]&63));else{if(!(248>code))throw new Error("Unable to represent UTF-8 string as UTF-16 JavaScript string.");byte3=byteArray[i+2],chars.push(String.fromCharCode(((7&code)<<8|(byteArray[i++]&63)<<2|(byteArray[i++]&63)>>4)&1023|55296)),chars.push(String.fromCharCode((15&byte3)<<6|byteArray[i++]&63|56320))}}return chars.join("")},UTF8.byteLength=function(str){var m;return m=encodeURIComponent(str).match(/%[89ABab]/g),str.length+(m?m.length:0)},UTF8}(),BrowserFS.StringUtil.ASCII=function(){function ASCII(){}return ASCII.str2byte=function(buf,str,offset,length){var i,_i;for(length=str.length>length?length:str.length,i=_i=0;length>=0?length>_i:_i>length;i=length>=0?++_i:--_i)buf.writeUInt8(str.charCodeAt(i)%256,offset+i);return buf._charsWritten=length,length},ASCII.byte2str=function(byteArray){var chars,i,_i,_ref1;for(chars=new Array(byteArray.length),i=_i=0,_ref1=byteArray.length;_ref1>=0?_ref1>_i:_i>_ref1;i=_ref1>=0?++_i:--_i)chars[i]=String.fromCharCode(byteArray[i]&127);return chars.join("")},ASCII.byteLength=function(str){return str.length},ASCII}(),BrowserFS.StringUtil.BASE64=function(){function BASE64(){}return BASE64.num2b64=function(){var i,idx,obj,_i,_len,_ref1;for(obj={},_ref1=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/","="],idx=_i=0,_len=_ref1.length;_len>_i;idx=++_i)i=_ref1[idx],obj[idx]=i;return obj}(),BASE64.b642num=function(){var i,idx,obj,_i,_len,_ref1;for(obj={},_ref1=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/","="],idx=_i=0,_len=_ref1.length;_len>_i;idx=++_i)i=_ref1[idx],obj[i]=idx;return obj["-"]=62,obj._=63,obj}(),BASE64.byte2str=function(byteArray){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,i,output;for(output="",i=0;i<byteArray.length;)chr1=byteArray[i++],chr2=byteArray[i++],chr3=byteArray[i++],enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+BrowserFS.StringUtil.BASE64.num2b64[enc1]+BrowserFS.StringUtil.BASE64.num2b64[enc2]+BrowserFS.StringUtil.BASE64.num2b64[enc3]+BrowserFS.StringUtil.BASE64.num2b64[enc4];return output},BASE64.str2byte=function(buf,str,offset,length){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,i,j,output;for(output="",i=0,str=str.replace(/[^A-Za-z0-9\+\/\=\-\_]/g,""),j=0;i<str.length&&(enc1=BrowserFS.StringUtil.BASE64.b642num[str.charAt(i++)],enc2=BrowserFS.StringUtil.BASE64.b642num[str.charAt(i++)],enc3=BrowserFS.StringUtil.BASE64.b642num[str.charAt(i++)],enc4=BrowserFS.StringUtil.BASE64.b642num[str.charAt(i++)],chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,buf.writeUInt8(chr1,offset+j++),j!==length)&&(64!==enc3&&(output+=buf.writeUInt8(chr2,offset+j++)),j!==length)&&(64!==enc4&&(output+=buf.writeUInt8(chr3,offset+j++)),j!==length););return buf._charsWritten=i>str.length?str.length:i,j},BASE64.byteLength=function(str){return Math.floor(str.replace(/[^A-Za-z0-9\+\/\-\_]/g,"").length*6/8)},BASE64}(),BrowserFS.StringUtil.UCS2=function(){function UCS2(){}return UCS2.str2byte=function(buf,str,offset,length){var i,len,_i;for(len=str.length,2*len>length&&(len=1===length%2?(length-1)/2:length/2),i=_i=0;len>=0?len>_i:_i>len;i=len>=0?++_i:--_i)buf.writeUInt16LE(str.charCodeAt(i),offset+2*i);return buf._charsWritten=len,2*len},UCS2.byte2str=function(byteArray){var chars,i,_i,_ref1;if(byteArray.length%2!==0)throw new Error("Invalid UCS2 byte array.");for(chars=new Array(byteArray.length/2),i=_i=0,_ref1=byteArray.length;_ref1>_i;i=_i+=2)chars[i/2]=String.fromCharCode(byteArray[i]|byteArray[i+1]<<8);return chars.join("")},UCS2.byteLength=function(str){return str.length*2},UCS2}(),BrowserFS.StringUtil.HEX=function(){function HEX(){}var HEXCHARS;return HEXCHARS="0123456789abcdef",HEX.num2hex=function(){var i,idx,obj,_i,_len;for(obj={},idx=_i=0,_len=HEXCHARS.length;_len>_i;idx=++_i)i=HEXCHARS[idx],obj[idx]=i;return obj}(),HEX.hex2num=function(){var i,idx,obj,_i,_j,_len,_len1,_ref1;for(obj={},idx=_i=0,_len=HEXCHARS.length;_len>_i;idx=++_i)i=HEXCHARS[idx],obj[i]=idx;for(_ref1="ABCDEF",idx=_j=0,_len1=_ref1.length;_len1>_j;idx=++_j)i=_ref1[idx],obj[i]=idx+10;return obj}(),HEX.str2byte=function(buf,str,offset,length){var char1,char2,i,numBytes,_i;if(str.length%2===1)throw new Error("Invalid hex string");for(numBytes=str.length/2,numBytes>length&&(numBytes=length),i=_i=0;numBytes>=0?numBytes>_i:_i>numBytes;i=numBytes>=0?++_i:--_i)char1=BrowserFS.StringUtil.HEX.hex2num[str.charAt(2*i)],char2=BrowserFS.StringUtil.HEX.hex2num[str.charAt(2*i+1)],buf.writeUInt8(char1<<4|char2,offset+i);return buf._charsWritten=2*numBytes,numBytes},HEX.byte2str=function(byteArray){var chars,hex1,hex2,i,j,len,_i;for(len=byteArray.length,chars=new Array(2*len),j=0,i=_i=0;len>=0?len>_i:_i>len;i=len>=0?++_i:--_i)hex2=byteArray[i]&15,hex1=byteArray[i]>>4,chars[j++]=BrowserFS.StringUtil.HEX.num2hex[hex1],chars[j++]=BrowserFS.StringUtil.HEX.num2hex[hex2];return chars.join("")},HEX.byteLength=function(str){return str.length/2},HEX}(),BrowserFS.StringUtil.BINSTR=function(){function BINSTR(){}return BINSTR.str2byte=function(buf,str,offset,length){var chr,endByte,firstChar,i,j,numBytes,startByte,_i;if(str.length===0)return buf._charsWritten=0,0;for(numBytes=BINSTR.byteLength(str),numBytes>length&&(numBytes=length),j=0,startByte=offset,endByte=startByte+numBytes,firstChar=str.charCodeAt(j++),0!==firstChar&&(buf.writeUInt8(255&firstChar,offset),startByte=offset+1),i=_i=startByte;endByte>_i;i=_i+=2)chr=str.charCodeAt(j++),1===endByte-i&&buf.writeUInt8(chr>>8,i),endByte-i>=2&&buf.writeUInt16BE(chr,i);return buf._charsWritten=Math.floor(numBytes/2)+1,numBytes},BINSTR.byte2str=function(byteArray){var chars,i,j,len,_i,_ref1;if(len=byteArray.length,0===len)return"";for(chars=new Array(Math.floor(len/2)+1),j=0,i=_i=0,_ref1=chars.length;_ref1>_i;i=_i+=1)chars[i]=0===i?1===len%2?String.fromCharCode(256|byteArray[j++]):String.fromCharCode(0):String.fromCharCode(byteArray[j++]<<8|byteArray[j++]);return chars.join("")},BINSTR.byteLength=function(str){var bytelen,firstChar;return str.length===0?0:(firstChar=str.charCodeAt(0),bytelen=(str.length-1)*2,0!==firstChar&&bytelen++,bytelen)},BINSTR}.call(this),BrowserFS.StringUtil.BINSTRIE=function(){function BINSTRIE(){}return BINSTRIE.str2byte=function(buf,str,offset,length){var i,_i;for(length=str.length>length?length:str.length,i=_i=0;length>=0?length>_i:_i>length;i=length>=0?++_i:--_i)buf.writeUInt8(str.charCodeAt(i)-32,offset+i);return buf._charsWritten=length,length},BINSTRIE.byte2str=function(byteArray){var chars,i,_i,_ref1;for(chars=new Array(byteArray.length),i=_i=0,_ref1=byteArray.length;_ref1>=0?_ref1>_i:_i>_ref1;i=_ref1>=0?++_i:--_i)chars[i]=String.fromCharCode(byteArray[i]+32);return chars.join("")},BINSTRIE.byteLength=function(str){return str.length},BINSTRIE}(),"undefined"!=typeof window&&null!==window)if(window.BrowserFS)for(name in BrowserFS)__hasProp.call(BrowserFS,name)&&(value=BrowserFS[name],window.BrowserFS[name]=value);else window.BrowserFS=BrowserFS;else{if("undefined"==typeof self||null===self)throw new Error("This library only supports node.js and modern browsers.");self.BrowserFS=BrowserFS}BrowserFS.FileIndex=function(){function FileIndex(){this._index={}}return FileIndex.prototype._split_path=function(path){var dirpath,itemname;return dirpath=BrowserFS.node.path.dirname(path),itemname=path.substr(dirpath.length+("/"===dirpath?0:1)),[dirpath,itemname]},FileIndex.prototype.addPath=function(path,inode){var dirpath,itemname,parent,_ref1;if(null==inode)throw new Error("Inode must be specified");if(path[0]!=="/")throw new Error("Path must be absolute, got: "+path);return this._index[path]!==void 0?this._index[path]===inode:(_ref1=this._split_path(path),dirpath=_ref1[0],itemname=_ref1[1],parent=this._index[dirpath],void 0!==parent||"/"===path||(parent=new BrowserFS.DirInode,this.addPath(dirpath,parent))?"/"===path||parent.addItem(itemname,inode)?(inode.isFile()||(this._index[path]=inode),!0):!1:!1)},FileIndex.prototype.removePath=function(path){var dirpath,inode,itemname,parent,_ref1;return _ref1=this._split_path(path),dirpath=_ref1[0],itemname=_ref1[1],parent=this._index[dirpath],void 0===parent?null:(inode=parent.remItem(itemname),null===inode?null:(inode.isFile()||delete this._index[path],inode))},FileIndex.prototype.ls=function(path){var item;return item=this._index[path],void 0===item?null:item.getListing()},FileIndex.prototype.getInode=function(path){var dirpath,itemname,parent,_ref1;return _ref1=this._split_path(path),dirpath=_ref1[0],itemname=_ref1[1],parent=this._index[dirpath],void 0===parent?null:dirpath===path?parent:parent.getItem(itemname)},FileIndex}(),BrowserFS.FileIndex.from_listing=function(listing){var children,idx,inode,node,parent,pwd,queue,rootInode,tree,_ref1;for(idx=new BrowserFS.FileIndex,rootInode=new BrowserFS.DirInode,idx._index["/"]=rootInode,queue=[["",listing,rootInode]];queue.length>0;){_ref1=queue.pop(),pwd=_ref1[0],tree=_ref1[1],parent=_ref1[2];for(node in tree)children=tree[node],name=""+pwd+"/"+node,null!=children?(idx._index[name]=inode=new BrowserFS.DirInode,queue.push([name,children,inode])):idx._index[name]=inode=new BrowserFS.FileInode(BrowserFS.node.fs.Stats.FILE,-1),null!=parent&&(parent._ls[node]=inode)}return idx},BrowserFS.FileInode=BrowserFS.node.fs.Stats,BrowserFS.DirInode=function(){function DirInode(){this._ls={}}return DirInode.prototype.isFile=function(){return!1},DirInode.prototype.isDirectory=function(){return!0},DirInode.prototype.getStats=function(){return new BrowserFS.node.fs.Stats(BrowserFS.node.fs.Stats.DIRECTORY,4096)},DirInode.prototype.getListing=function(){return Object.keys(this._ls)},DirInode.prototype.getItem=function(p){var _ref1;return(_ref1=this._ls[p])!=null?_ref1:null},DirInode.prototype.addItem=function(p,inode){return p in this._ls?!1:(this._ls[p]=inode,!0)},DirInode.prototype.remItem=function(p){var item;return item=this._ls[p],void 0===item?null:(delete this._ls[p],item)},DirInode}(),BrowserFS.IndexedFileSystem=function(_super){function IndexedFileSystem(_index){this._index=_index}return __extends(IndexedFileSystem,_super),IndexedFileSystem.prototype.renameSync=function(oldPath,newPath){var oldInode;if(oldInode=this._index.removePath(oldPath),null===oldInode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+oldPath+" not found.");this._index.removePath(newPath),this._index.addPath(newPath,oldInode)},IndexedFileSystem.prototype.statSync=function(path,isLstat){var inode,stats,_ref1;if(inode=this._index.getInode(path),null===inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.");return stats=(_ref1=typeof inode.getStats=="function"?inode.getStats():void 0)!=null?_ref1:inode},IndexedFileSystem.prototype.openSync=function(path,flags,mode){var inode;if(inode=this._index.getInode(path),null!==inode){if(!inode.isFile())throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a directory.");switch(flags.pathExistsAction()){case BrowserFS.FileMode.THROW_EXCEPTION:throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,""+path+" already exists.");case BrowserFS.FileMode.TRUNCATE_FILE:return this._truncate(path,flags,inode);case BrowserFS.FileMode.NOP:return this._fetch(path,flags,inode);default:throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid FileMode object.")}}else switch(flags.pathNotExistsAction()){case BrowserFS.FileMode.CREATE_FILE:return inode=new BrowserFS.node.fs.Stats(BrowserFS.node.fs.Stats.FILE,0,mode),this._create(path,flags,inode);
case BrowserFS.FileMode.THROW_EXCEPTION:throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,""+path+" doesn't exist.");default:throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid FileMode object.")}},IndexedFileSystem.prototype.unlinkSync=function(path){var inode;if(inode=this._index.getInode(path),null===inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.");if(!inode.isFile())throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a directory, not a file.");this._index.removePath(path)},IndexedFileSystem.prototype.rmdirSync=function(path){var inode;if(inode=this._index.getInode(path),null===inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.");if(inode.isFile())throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a file, not a directory.");return this._index.removePath(path),this._rmdirSync(path,inode)},IndexedFileSystem.prototype.mkdirSync=function(path,mode){var inode,parent,success;if(inode=this._index.getInode(path),null!==inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,""+path+" already exists.");if(parent=BrowserFS.node.path.dirname(path),"/"!==parent&&this._index.getInode(parent)===null)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Can't create "+path+" because "+parent+" doesn't exist.");if(success=this._index.addPath(path,new BrowserFS.DirInode),!success)throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Could not add "+path+" for some reason.")},IndexedFileSystem.prototype.readdirSync=function(path){var inode;if(inode=this._index.getInode(path),null===inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.");if(inode.isFile())throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a file, not a directory.");return inode.getListing()},IndexedFileSystem.prototype.chmodSync=function(path,isLchmod,mode){var fd;fd=this.openSync(path,BrowserFS.FileMode.getFileMode("r+"),420),fd._stat.mode=mode,fd.closeSync()},IndexedFileSystem.prototype.chownSync=function(path,isLchown,uid,gid){var fd;fd=this.openSync(path,BrowserFS.FileMode.getFileMode("r+"),420),fd._stat.uid=uid,fd._stat.gid=gid,fd.closeSync()},IndexedFileSystem.prototype.utimesSync=function(path,atime,mtime){var fd;fd=this.openSync(path,BrowserFS.FileMode.getFileMode("r+"),420),fd._stat.atime=atime,fd._stat.mtime=mtime,fd.closeSync()},IndexedFileSystem}(BrowserFS.SynchronousFileSystem),BrowserFS.File.PreloadFile=function(_super){function PreloadFile(_fs,_path,_mode,_stat,contents){if(this._fs=_fs,this._path=_path,this._mode=_mode,this._stat=_stat,this._pos=0,this._buffer=null!=contents&&contents instanceof BrowserFS.node.Buffer?contents:new BrowserFS.node.Buffer(0),this._stat.size!==this._buffer.length)throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return __extends(PreloadFile,_super),PreloadFile.prototype.getPath=function(){return this._path},PreloadFile.prototype.getPos=function(){return this._mode.isAppendable()?this._stat.size:this._pos},PreloadFile.prototype.advancePos=function(delta){return this._pos+=delta},PreloadFile.prototype.setPos=function(newPos){return this._pos=newPos},PreloadFile.prototype.sync=function(cb){var e;try{return this.syncSync(),cb()}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.syncSync=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},PreloadFile.prototype.close=function(cb){var e;try{return this.closeSync(),cb()}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.closeSync=function(){throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED)},PreloadFile.prototype.stat=function(cb){var e;try{return cb(null,this._stat.clone())}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.statSync=function(){return this._stat.clone()},PreloadFile.prototype.truncate=function(len,cb){var e;try{return this.truncateSync(len),cb()}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.truncateSync=function(len,cb){var buf;if(!this._mode.isWriteable())throw new BrowserFS.ApiError(BrowserFS.ApiError.PERMISSIONS_ERROR,"File not opened with a writeable mode.");return this._stat.mtime=new Date,len>this._buffer.length?(buf=new Buffer(len-this._buffer.length),buf.fill(0),this.writeSync(buf,0,buf.length,this._buffer.length),this._mode.isSynchronous()&&this.syncSync(),void 0):(this._stat.size=len,this._mode.isSynchronous()&&this.syncSync(),void 0)},PreloadFile.prototype.write=function(buffer,offset,length,position,cb){var e;try{return cb(null,this.writeSync(buffer,offset,length,position),buffer)}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.writeSync=function(buffer,offset,length,position){var endFp,len,newBuff;if(null==position&&(position=this.getPos()),!this._mode.isWriteable())throw new BrowserFS.ApiError(BrowserFS.ApiError.PERMISSIONS_ERROR,"File not opened with a writeable mode.");return endFp=position+length,endFp>this._stat.size&&(this._stat.size=endFp,endFp>this._buffer.length&&(newBuff=new Buffer(endFp),this._buffer.copy(newBuff),this._buffer=newBuff)),len=buffer.copy(this._buffer,position,offset,offset+length),this._stat.mtime=new Date,this._mode.isSynchronous()?(this.syncSync(),len):(this.setPos(position+len),len)},PreloadFile.prototype.read=function(buffer,offset,length,position,cb){var e;try{return cb(null,this.readSync(buffer,offset,length,position),buffer)}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.readSync=function(buffer,offset,length,position){var endRead,rv;if(!this._mode.isReadable())throw new BrowserFS.ApiError(BrowserFS.ApiError.PERMISSIONS_ERROR,"File not opened with a readable mode.");return null==position&&(position=this.getPos()),endRead=position+length,endRead>this._stat.size&&(length=this._stat.size-position),rv=this._buffer.copy(buffer,offset,position,position+length),this._stat.atime=new Date,this._pos=position+length,rv},PreloadFile.prototype.chmod=function(mode,cb){var e;try{return this.chmodSync(mode),cb()}catch(_error){return e=_error,cb(e)}},PreloadFile.prototype.chmodSync=function(mode){if(!this._fs.supportsProps())throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_SUPPORTED);this._stat.mode=mode,this.syncSync()},PreloadFile}(BrowserFS.File),BrowserFS.File.NoSyncFile=function(_super){function NoSyncFile(){return _ref1=NoSyncFile.__super__.constructor.apply(this,arguments)}return __extends(NoSyncFile,_super),NoSyncFile.prototype.sync=function(cb){return cb()},NoSyncFile.prototype.syncSync=function(){},NoSyncFile.prototype.close=function(cb){return cb()},NoSyncFile.prototype.closeSync=function(){},NoSyncFile}(BrowserFS.File.PreloadFile),document.write("<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n Dim lastIndex\r\n lastIndex = LenB(Binary)\r\n if lastIndex mod 2 Then\r\n IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n Else\r\n IEBinaryToArray_ByteStr_Last = \"\"\r\n End If\r\nEnd Function\r\n</script>\r\n"),BrowserFS.FileSystem.XmlHttpRequest=function(_super){function XmlHttpRequest(listing_url){var listing;if(null==listing_url&&(listing_url="index.json"),listing=JSON.parse(this._request_file(listing_url,"json")),null==listing)throw new Error("Unable to find listing at URL: "+listing_url);this._index=BrowserFS.FileIndex.from_listing(listing)}return __extends(XmlHttpRequest,_super),XmlHttpRequest.prototype.empty=function(){var k,v,_ref2,_results;_ref2=this._index._index,_results=[];for(k in _ref2)v=_ref2[k],v.file_data!=null&&_results.push(v.file_data=void 0);return _results},XmlHttpRequest.prototype._request_file_modern=function(path,data_type,cb){var data,req;return req=new XMLHttpRequest,req.open("GET",path,null!=cb),null!=cb&&(req.responseType=data_type),data=null,req.onerror=function(e){return console.error(req.statusText)},req.onload=function(e){var _ref2;return(req.readyState!==4||req.status!==200)&&console.error(req.statusText),data=BrowserFS.node.Buffer((_ref2=req.response)!=null?_ref2:0),"function"==typeof cb?cb(data):void 0},req.send(),null!=data&&"NOT FOUND"!==data?data:void 0},XmlHttpRequest.prototype._request_file_size=function(path,cb){var req;return req=new XMLHttpRequest,req.open("HEAD",path),req.onerror=function(e){return console.error(req.statusText)},req.onload=function(e){return(req.readyState!==4||req.status!==200)&&console.error(req.statusText),cb(req.getResponseHeader("Content-Length"))},req.send()},XmlHttpRequest.prototype._GetIEByteArray_ByteStr=function(IEByteArray){var lastChr,rawBytes;return rawBytes=IEBinaryToArray_ByteStr(IEByteArray),lastChr=IEBinaryToArray_ByteStr_Last(IEByteArray),rawBytes.replace(/[\s\S]/g,function(match){var v;return v=match.charCodeAt(0),String.fromCharCode(255&v,v>>8)})+lastChr},XmlHttpRequest.prototype._request_file_IE=function(path,data_type,cb){var data,req,_this=this;return req=new XMLHttpRequest,req.open("GET",path,null!=cb),req.setRequestHeader("Accept-Charset","x-user-defined"),data=null,req.onerror=function(e){return console.error(req.statusText)},req.onload=function(e){var data_array;return(req.readyState!==4||req.status!==200)&&console.error(req.statusText),data_array=_this._GetIEByteArray_ByteStr(req.responseBody),data=BrowserFS.node.Buffer(data_array),"function"==typeof cb?cb(data):void 0},req.send(),null!=data&&"NOT FOUND"!==data?data:void 0},XmlHttpRequest.prototype._request_file=BrowserFS.isIE&&!window.Blob?XmlHttpRequest.prototype._request_file_IE:XmlHttpRequest.prototype._request_file_modern,XmlHttpRequest.prototype.getName=function(){return"XmlHttpRequest"},XmlHttpRequest.isAvailable=function(){return"undefined"!=typeof XMLHttpRequest&&null!==XMLHttpRequest},XmlHttpRequest.prototype.diskSpace=function(path,cb){return cb(0,0)},XmlHttpRequest.prototype.isReadOnly=function(){return!0},XmlHttpRequest.prototype.supportsLinks=function(){return!1},XmlHttpRequest.prototype.supportsProps=function(){return!1},XmlHttpRequest.prototype.preloadFile=function(path,buffer){var inode;if(inode=this._index.getInode(path),null===inode)throw new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.");inode.size=buffer.length,inode.file_data=new BrowserFS.File.NoSyncFile(this,path,BrowserFS.FileMode.getFileMode("r"),inode,buffer)},XmlHttpRequest.prototype.stat=function(path,isLstat,cb){var inode,stats,_ref2;return inode=this._index.getInode(path),null===inode?cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.")):(inode.size<0?this._request_file_size(path,function(size){return inode.size=size,cb(null,inode)}):(stats=(_ref2=typeof inode.getStats=="function"?inode.getStats():void 0)!=null?_ref2:inode,cb(null,stats)),void 0)},XmlHttpRequest.prototype.open=function(path,flags,mode,cb){var inode,_this=this;if(inode=this._index.getInode(path),null===inode)return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is not in the FileIndex."));if(inode.isDirectory())return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a directory."));switch(flags.pathExistsAction()){case BrowserFS.FileMode.THROW_EXCEPTION:case BrowserFS.FileMode.TRUNCATE_FILE:return cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" already exists."));case BrowserFS.FileMode.NOP:if(inode.file_data!=null)return cb(null,inode.file_data);this._request_file(path,"arraybuffer",function(buffer){return inode.size=buffer.length,inode.file_data=new BrowserFS.File.NoSyncFile(_this,path,flags,inode,buffer),cb(null,inode.file_data)});break;default:return cb(new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Invalid FileMode object."))}},XmlHttpRequest.prototype.readdir=function(path,cb){var inode;return inode=this._index.getInode(path),null===inode?cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" not found.")):inode.isFile()?cb(new BrowserFS.ApiError(BrowserFS.ApiError.NOT_FOUND,""+path+" is a file, not a directory.")):cb(null,inode.getListing())},XmlHttpRequest}(BrowserFS.FileSystem),BrowserFS.FileSystem.InMemory=function(_super){function InMemory(){this.empty()}return __extends(InMemory,_super),InMemory.prototype.empty=function(){return this._index=new BrowserFS.FileIndex},InMemory.prototype.getName=function(){return"In-memory"},InMemory.isAvailable=function(){return!0},InMemory.prototype.diskSpace=function(path,cb){return cb(1/0,BrowserFS.util.roughSizeOfObject(this._index))},InMemory.prototype.isReadOnly=function(){return!1},InMemory.prototype.supportsLinks=function(){return!1},InMemory.prototype.supportsProps=function(){return!1},InMemory.prototype._truncate=function(path,flags,inode){var file;return inode.size=0,inode.mtime=new Date,file=inode.file_data,file._mode=flags,file._buffer=new BrowserFS.node.Buffer(0),file},InMemory.prototype._fetch=function(path,flags,inode){var file;return file=inode.file_data,file._mode=flags,file},InMemory.prototype._create=function(path,flags,inode){var file;return file=new BrowserFS.File.NoSyncFile(this,path,flags,inode),inode.file_data=file,this._index.addPath(path,inode),file},InMemory.prototype._rmdirSync=function(path,inode){},InMemory}(BrowserFS.IndexedFileSystem),BrowserFS.FileSystem.LocalStorage=function(_super){function LocalStorage(){var data,i,inode,len,path,_i,_ref2,_ref3;for(this._index=new BrowserFS.FileIndex,i=_i=0,_ref2=window.localStorage.length;_ref2>_i;i=_i+=1)path=window.localStorage.key(i),path[0]==="/"&&(data=(_ref3=window.localStorage.getItem(path))!=null?_ref3:"",len=this._getFileLength(data),inode=new BrowserFS.FileInode(BrowserFS.node.fs.Stats.FILE,len),this._index.addPath(path,inode))}var e,supportsBinaryString;__extends(LocalStorage,_super),LocalStorage.prototype._getFile=function(path,flags,inode){var data;return data=window.localStorage.getItem(path),null===data?null:this._convertFromBinaryString(path,data,flags,inode)},LocalStorage.prototype._syncSync=function(path,data,inode){var e;data=this._convertToBinaryString(data,inode);try{window.localStorage.setItem(path,data),this._index.addPath(path,inode)}catch(_error){throw e=_error,new BrowserFS.ApiError(BrowserFS.ApiError.DRIVE_FULL,"Unable to sync "+path)}};try{window.localStorage.setItem("__test__",String.fromCharCode(55296)),supportsBinaryString=window.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch(_error){e=_error,supportsBinaryString=!1}return supportsBinaryString?(LocalStorage.prototype._convertToBinaryString=function(data,inode){var headerBuff,headerDat;return data=data.toString("binary_string"),headerBuff=new BrowserFS.node.Buffer(18),headerBuff.writeUInt16BE(inode.mode,0),headerBuff.writeDoubleBE(inode.mtime.getTime(),2),headerBuff.writeDoubleBE(inode.atime.getTime(),10),headerDat=headerBuff.toString("binary_string"),data=headerDat+data},LocalStorage.prototype._convertFromBinaryString=function(path,data,flags,inode){var buffer,file,headerBuff;return headerBuff=new BrowserFS.node.Buffer(data.substr(0,10),"binary_string"),data=data.substr(10),buffer=new BrowserFS.node.Buffer(data,"binary_string"),file=new BrowserFS.File.PreloadFile.LocalStorageFile(this,path,flags,inode,buffer),file._stat.mode=headerBuff.readUInt16BE(0),file._stat.mtime=new Date(headerBuff.readDoubleBE(2)),file._stat.atime=new Date(headerBuff.readDoubleBE(10)),file},LocalStorage.prototype._getFileLength=function(data){return data.length>10?BrowserFS.StringUtil.FindUtil("binary_string").byteLength(data.substr(10)):0}):(LocalStorage.prototype._convertToBinaryString=function(data,inode){var headerBuff,headerDat;return data=data.toString("binary_string_ie"),headerBuff=new BrowserFS.node.Buffer(18),headerBuff.writeUInt16BE(inode.mode,0),headerBuff.writeDoubleBE(inode.mtime.getTime(),2),headerBuff.writeDoubleBE(inode.atime.getTime(),10),headerDat=headerBuff.toString("binary_string_ie"),data=headerDat+data},LocalStorage.prototype._convertFromBinaryString=function(path,data,flags,inode){var buffer,file,headerBuff;return headerBuff=new BrowserFS.node.Buffer(data.substr(0,18),"binary_string_ie"),data=data.substr(18),buffer=new BrowserFS.node.Buffer(data,"binary_string_ie"),file=new BrowserFS.File.PreloadFile.LocalStorageFile(this,path,flags,inode,buffer),file._stat.mode=headerBuff.readUInt16BE(0),file._stat.mtime=new Date(headerBuff.readDoubleBE(2)),file._stat.atime=new Date(headerBuff.readDoubleBE(10)),file},LocalStorage.prototype._getFileLength=function(data){return data.length>0?data.length-18:0}),LocalStorage.prototype.empty=function(){return window.localStorage.clear(),this._index=new BrowserFS.FileIndex},LocalStorage.prototype.getName=function(){return"localStorage"},LocalStorage.isAvailable=function(){return("undefined"!=typeof window&&null!==window?window.localStorage:void 0)!=null},LocalStorage.prototype.diskSpace=function(path,cb){var data,i,key,remaining,storageLimit,usedSpace,_i;for(storageLimit=5242880,usedSpace=0,i=_i=0;length>=0?length>_i:_i>length;i=length>=0?++_i:--_i)key=window.localStorage.key(i),usedSpace+=key.length*2,data=window.localStorage.getItem(key),usedSpace+=data.length*2;return window.localStorage.remainingSpace!=null&&(remaining=window.localStorage.remainingSpace(),storageLimit=usedSpace+remaining),cb(storageLimit,usedSpace)},LocalStorage.prototype.isReadOnly=function(){return!1},LocalStorage.prototype.supportsLinks=function(){return!1},LocalStorage.prototype.supportsProps=function(){return!0},LocalStorage.prototype.unlinkSync=function(path){return LocalStorage.__super__.unlinkSync.call(this,path),window.localStorage.removeItem(path)},LocalStorage.prototype._truncate=function(path,flags,inode){return inode.size=0,new BrowserFS.File.PreloadFile.LocalStorageFile(this,path,flags,inode)},LocalStorage.prototype._fetch=function(path,flags,inode){return this._getFile(path,flags,inode)},LocalStorage.prototype._create=function(path,flags,inode){return new BrowserFS.File.PreloadFile.LocalStorageFile(this,path,flags,inode)},LocalStorage.prototype._rmdirSync=function(path,inode){var file,files,sep,_i,_len;for(files=inode.getListing(),sep=BrowserFS.node.path.sep,_i=0,_len=files.length;_len>_i;_i++)file=files[_i],window.localStorage.removeItem(""+path+sep+file)},LocalStorage}(BrowserFS.IndexedFileSystem),BrowserFS.File.PreloadFile.LocalStorageFile=function(_super){function LocalStorageFile(){return _ref2=LocalStorageFile.__super__.constructor.apply(this,arguments)}return __extends(LocalStorageFile,_super),LocalStorageFile.prototype.syncSync=function(){this._fs._syncSync(this._path,this._buffer,this._stat)},LocalStorageFile.prototype.closeSync=function(){return this.syncSync()},LocalStorageFile}(BrowserFS.File.PreloadFile),BrowserFS.FileSystem.MountableFileSystem=function(_super){function MountableFileSystem(){this.mntMap={},this.rootFs=new BrowserFS.FileSystem.InMemory}var cmds,defineFcn,fnName,fsCmdMap,i,j,_i,_j,_ref3,_ref4;for(__extends(MountableFileSystem,_super),MountableFileSystem.prototype.mount=function(mnt_pt,fs){if(this.mntMap[mnt_pt])throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Mount point "+mnt_pt+" is already taken.");return this.rootFs.mkdirSync(mnt_pt),this.mntMap[mnt_pt]=fs},MountableFileSystem.prototype.umount=function(mnt_pt){if(!this.mntMap[mnt_pt])throw new BrowserFS.ApiError(BrowserFS.ApiError.INVALID_PARAM,"Mount point "+mnt_pt+" is already unmounted.");return delete this.mntMap[mnt_pt],this.rootFs.rmdirSync(mnt_pt)},MountableFileSystem.prototype._get_fs=function(path){var fs,mnt_pt,_ref3;_ref3=this.mntMap;for(mnt_pt in _ref3)if(fs=_ref3[mnt_pt],path.indexOf(mnt_pt)===0)return path=path.substr(mnt_pt.length>1?mnt_pt.length:0),""===path&&(path="/"),[fs,path];return[this.rootFs,path]},MountableFileSystem.prototype.getName=function(){return"MountableFileSystem"},MountableFileSystem.isAvailable=function(){return!0},MountableFileSystem.prototype.diskSpace=function(path,cb){return cb(0,0)},MountableFileSystem.prototype.isReadOnly=function(){return!1},MountableFileSystem.prototype.supportsLinks=function(){return!1},MountableFileSystem.prototype.supportsProps=function(){return!1},MountableFileSystem.prototype.supportsSynch=function(){return!0},defineFcn=function(name,isSync,numArgs){return function(){var args,rv;return args=1<=arguments.length?__slice.call(arguments,0):[],rv=this._get_fs(args[0]),args[0]=rv[1],rv[0][name].apply(rv[0],args)}},fsCmdMap=[["readdir","exists","unlink","rmdir","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],i=_i=0,_ref3=fsCmdMap.length;_ref3>_i;i=_i+=1)for(cmds=fsCmdMap[i],j=_j=0,_ref4=cmds.length;_ref4>_j;j=_j+=1)fnName=cmds[j],MountableFileSystem.prototype[fnName]=defineFcn(fnName,!1,i+1),MountableFileSystem.prototype[fnName+"Sync"]=defineFcn(fnName+"Sync",!0,i+1);return MountableFileSystem.prototype.rename=function(oldPath,newPath,cb){var fs1_rv,fs2_rv;return fs1_rv=this._get_fs(oldPath),fs2_rv=this._get_fs(newPath),fs1_rv instanceof BrowserFS.ApiError?cb(fs1_rv):fs2_rv instanceof BrowserFS.ApiError?cb(fs2_rv):fs1_rv[0]===fs2_rv[0]?fs1_rv[0].rename(fs1_rv[1],fs2_rv[1],cb):BrowserFS.node.fs.readFile(oldPath,function(err,data){return err?cb(err):BrowserFS.node.fs.writeFile(newPath,data,function(err){return err?cb(err):BrowserFS.node.fs.unlink(oldPath,cb)})})},MountableFileSystem.prototype.renameSync=function(oldPath,newPath){var data,fs1_rv,fs2_rv;if(fs1_rv=this._get_fs(oldPath),fs2_rv=this._get_fs(newPath),fs1_rv instanceof BrowserFS.ApiError)throw fs1_rv;if(fs2_rv instanceof BrowserFS.ApiError)throw fs2_rv;return fs1_rv[0]===fs2_rv[0]?fs1_rv[0].renameSync(fs1_rv[1],fs2_rv[1]):(data=BrowserFS.node.fs.readFileSync(oldPath),BrowserFS.node.fs.writeFileSync(newPath,data),BrowserFS.node.fs.unlinkSync(oldPath))},MountableFileSystem}(BrowserFS.FileSystem)}.call(this);
/*
//@ sourceMappingURL=lib/browserfs.min.map
*/